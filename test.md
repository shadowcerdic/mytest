# بررسی و اصلاح متن «فرآیند System و Memory Compression»

## مقدمه  
در این سند، ابتدا بخش‌های اصلی متن موجود تحلیل می‌شوند و سپس نسخهٔ بازنویس‌شده‌ای ارائه خواهد شد که هماهنگ با جامعهٔ امنیت سایبری و قابل پیاده‌سازی در محیط‌های واقعی باشد.  

---

## تحلیل بخش «فرآیند System»

### معیار کاربردی بودن  
- توضیح داده شده که PID فرآیند ثابت است و میزبان تردهای حالت هسته است، اما خواننده نمی‌داند چگونه این اطلاعات را در محیط عملی برای تشخیص تهدید به کار ببرد.  
- نیاز به اشاره به ابزارها و دستورات مشخص (مثلاً دستور <bdi dir="ltr">tasklist /svc</bdi>) برای تأیید PID و parent/child relationships وجود دارد.

### معیار عملی بودن و قابلیت پیاده‌سازی  
- اشاره به تفاوت نام‌ها در ابزارهای مختلف مفید است، اما نیاز به ذکر تنظیمات و نسخه‌های ویندوزی دارد (مثلاً از ویندوز 10 نسخه 1803 به بعد).  
- نبود مثال‌های تصویری یا خروجی واقعی ابزارها، پیاده‌سازی را سخت می‌کند.

### معیار نزدیکی به واقعیت‌های میدانی  
- بیان شده که هر فرآیند فرزند به جز <bdi dir="ltr">smss.exe</bdi> می‌تواند نشانه نفوذ باشد، اما در نسخه‌های به‌روز گاهی سرویس‌های سیستم دیگر فرزند <bdi dir="ltr">System</bdi> نیز هستند (مثل عملکرد <bdi dir="ltr">Memory Compression</bdi>) که باید بررسی شوند.

### معیار درستی فنی و منطقی  
- تعریف «نمایش فعالیت‌های هسته» دقیق است، اما در مورد مسیر اجرایی و نام ساده‌سازی بیش از حد شده.  
- باید به تفاوت بین <bdi dir="ltr">Kernel Mode Service Host (svchost.exe)</bdi> و خود <bdi dir="ltr">ntoskrnl.exe</bdi> اشاره کند.

### ارائه راهکار و ارزش افزوده  
- متن تنها توصیف کرده و راهکاری برای شناسایی و پایش فرآیندهای مبتنی بر <bdi dir="ltr">System</bdi> ارائه نکرده است.  
- پیشنهاد می‌شود افزون بر Task Manager، از <bdi dir="ltr">Sysinternals Autoruns</bdi> یا <bdi dir="ltr">Windows Event Logs</bdi> برای بررسی parent/child mapping استفاده شود.

### ساختار و انسجام  
- دو پاراگراف جدا وجود دارد، اما نیاز به مقدمهٔ کوتاه و نتیجه‌گیری مشخص است.  
- پیوند معنایی بین بخش‌ها برقرار نشده و هر کدام مستقل توضیح داده شده‌اند.

### وضوح و خوانایی  
- جملات طولانی و اصطلاحات کم‌توضیح هستند.  
- باید واژگان تخصصی با تعریف کوتاه همراه باشند.

### اصالت و نوآوری  
- بیشتر جنبهٔ شرح مختصر است و کمتر تحلیل یا بینش جدید دارد.  
- افزودن نکته‌های تجربی (مثلاً روش پایش تغییرات PID یا نمونه نفوذی که Child process جعلی ایجاد می‌کند) نوآوری محسوب می‌شود.

### ارجاع‌دهی و منابع  
- هیچ منبع یا استانداردی نظیر مستندات مایکروسافت یا گزارش‌های CERT ذکر نشده است.  

---

## تحلیل بخش «فرآیند Memory Compression»

### معیار کاربردی بودن  
- وظیفه و هدف فشرده‌سازی RAM به جای paging توضیح داده شده اما نحوهٔ نظارت بر مصرف حافظه فشرده نشده است.

### معیار عملی بودن و قابلیت پیاده‌سازی  
- باید دستور <bdi dir="ltr">Get-MMAgent</bdi> در <bdi dir="ltr">PowerShell</bdi> و متغیرهای <bdi dir="ltr">MemoryInUse</bdi>، <bdi dir="ltr">CompressedMemoryInUse</bdi> ذکر شود تا اجرای عملی فراهم شود.

### معیار نزدیکی به واقعیت‌های میدانی  
- تحلیلگرانی که با این فرآیند آشنا نیستند، بیشتر به آن به چشم بدافزار نگاه می‌کنند؛ پیشنهاد می‌شود نمونه‌ای از شناسهٔ <bdi dir="ltr">Process GUID</bdi> یا Event ID مربوطه ارائه شود.

### معیار درستی فنی و منطقی  
- متن درست است، اما جای توضیح مکانیسم‌های فشرده‌سازی (LSZ compression) و تأثیر آن بر عملکرد سیستم وجود دارد.

### ارائه راهکار و ارزش افزوده  
- راهکار پیشنهادی برای تشخیص فعالیت غیرمعمول در این فرآیند وجود ندارد.  
- افزون بر آن، اشاره به ابزار <bdi dir="ltr">RAMMap</bdi> برای مشاهده Real-time memory breakdown می‌تواند ارزشمند باشد.

### ساختار و انسجام  
- توضیحات پراکنده‌اند و نیاز به تقسیم‌بندی به زیرعنوان‌هایی مثل «وظیفه»، «نحوهٔ نظارت» و «سناریوهای تهدید» دارد.

### وضوح و خوانایی  
- لازم است از جملات کوتاه‌تر و مثال‌های عددی برای نشان‌دادن تأثیر استفاده شود.

### اصالت و نوآوری  
- توضیحات پایه هستند؛ اضافه‌کردن یک سناریو حمله واقعی (مثلاً یک rootkit که از نام مشابه سوءاستفاده می‌کند) نوآوری ایجاد می‌کند.

### ارجاع‌دهی و منابع  
- به منابع MSDN یا TechNet و مقالات مروری در مورد مکانیزم Memory Compression ارجاع داده نشده است.  

---

## بازنویسی پیشنهادی

<bdi dir="rtl">
در این راهنمای کاربردی، ابتدا به معرفی و ویژگی‌های کلیدی فرآیند <bdi dir="ltr">System</bdi> می‌پردازیم، سپس مکانیسم <bdi dir="ltr">Memory Compression</bdi> را تشریح می‌کنیم و در پایان روش‌های پایش، شناسایی نشانه‌های نفوذ و بهینه‌سازی عملکرد را مرور خواهیم کرد.

### مقدمه  
فرآیند <bdi dir="ltr">System</bdi> و زیرمجموعهٔ جدید آن یعنی <bdi dir="ltr">Memory Compression</bdi> ستون فقرات مدیریت حافظه و عملکرد هستهٔ ویندوز هستند. آشنایی دقیق با ویژگی‌ها، نحوهٔ شناسایی غیرعادی‌ها و پیاده‌سازی سیاست‌های پایش، از ضروریات هر تحلیلگر امنیتی است.

### ویژگی‌های فرآیند <bdi dir="ltr">System</bdi>  
- PID ثابت: همیشه برابر 4 است.  
- میزبان تمام تردهای حالت هسته است و در فضای کاربر نمایش داده نمی‌شود.  
- نام در ابزارها:
  - Task Manager و <bdi dir="ltr">Process Hacker</bdi>: <bdi dir="ltr">ntoskrnl.exe</bdi>  
  - <bdi dir="ltr">Process Explorer</bdi>: «None»  
- فرزند اصلی: <bdi dir="ltr">smss.exe</bdi>. هر فرزند اضافهٔ دیگر می‌تواند نشانه نفوذ باشد.

### پایش و شناسایی تهدید در <bdi dir="ltr">System</bdi>  
1. اجرای دستور در <bdi dir="ltr">PowerShell</bdi>:
   <bdi dir="ltr">Get-Process -Id 4 | Select-Object ProcessName,Id,Path</bdi>  
2. بررسی ارتباط والد/فرزند با:
   <bdi dir="ltr">tasklist /svc /fi "PID eq 4"</bdi>  
3. استفاده از <bdi dir="ltr">Sysinternals Autoruns</bdi> برای شناسایی سرویس‌های بارگذاری‌شده از فضای هسته.  
4. مشاهده رویدادهای امنیتی ویندوز (Event ID 4688) برای ثبت فرآیندهای کودک غیرمجاز.

### مکانیسم و وظیفهٔ <bdi dir="ltr">Memory Compression</bdi>  
- از ویندوز 10 نسخه 1803 اضافه شده است.  
- فشرده‌سازی حافظه در RAM با استفاده از الگوریتم‌های <bdi dir="ltr">LSZ</bdi> برای کاهش صفحه‌بندی به دیسک.  
- والد: فرآیند <bdi dir="ltr">System</bdi> | هیچ فرزند: ندارد.  
- اجرا تحت حساب <bdi dir="ltr">Local System</bdi> و وجود تنها یک نمونه در سیستم.

### پایش و بهینه‌سازی <bdi dir="ltr">Memory Compression</bdi>  
- فرمان <bdi dir="ltr">Get-MMAgent</bdi> در <bdi dir="ltr">PowerShell</bdi> و پارامترهای <bdi dir="ltr">MemoryInUse</bdi>، <bdi dir="ltr">CompressedMemoryInUse</bdi>:  
  <bdi dir="ltr">Get-MMAgent | Format-List</bdi>  
- بررسی Real-time با <bdi dir="ltr">RAMMap</bdi>.  
- تعریف آستانهٔ هشدار (مثلاً فشرده‌سازی بیش از 50٪ RAM) و تنظیم اعلان از طریق <bdi dir="ltr">Event Viewer</bdi>.

### سناریوهای تهدید و اقدامات مقابله  
- مخرب‌هایی که با نام‌های مشابه (<bdi dir="ltr">MemoryManager.exe</bdi>) خود را جایگزین می‌کنند:  
  - بررسی checksum فایل با <bdi dir="ltr">Get-FileHash</bdi>.  
  - پایش تغییرات مسیر فایل در شاخهٔ <bdi dir="ltr">System32</bdi>.  
- رخنه‌های LPE (Local Privilege Escalation) که در تردهای هسته رخ می‌دهد:  
  - اعمال سیاست <bdi dir="ltr">Windows Defender Credential Guard</bdi>  
  - محدودسازی دسترسی مستقیم به APIهای هسته.

### نتیجه‌گیری  
شناخت دقیق ساختار و عملکرد فرآیند <bdi dir="ltr">System</bdi> و زیرسیستم <bdi dir="ltr">Memory Compression</bdi>، همراه با پیاده‌سازی روال‌های پایش مستمر و اتوماسیون هشداردهی، ضریب اطمینان دفاع در برابر حملات مبتنی بر فضای هسته را به‌طور چشمگیری افزایش می‌دهد.</bdi>
