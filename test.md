<!DOCTYPE html>
<html lang="fa">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุชุญูู ุนูู ูุฑุขูุฏูุง ุญุงุช ููุฏูุฒ - ุฑุงูููุง ุดฺฉุงุฑ ุชูุฏุฏุงุช</title>
    <style>
        body {
            font-family: 'Tahoma', 'Arial', sans-serif;
            line-height: 1.8;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background-color: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #1a5490;
            border-bottom: 3px solid #1a5490;
            padding-bottom: 10px;
        }
        h2 {
            color: #2c3e50;
            margin-top: 30px;
            border-right: 5px solid #3498db;
            padding-right: 15px;
        }
        h3 {
            color: #34495e;
            margin-top: 25px;
        }
        .warning-box {
            background-color: #fff3cd;
            border-right: 4px solid #ffc107;
            padding: 15px;
            margin: 15px 0;
        }
        .info-box {
            background-color: #d1ecf1;
            border-right: 4px solid #17a2b8;
            padding: 15px;
            margin: 15px 0;
        }
        .danger-box {
            background-color: #f8d7da;
            border-right: 4px solid #dc3545;
            padding: 15px;
            margin: 15px 0;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-size: 14px;
        }
        th {
            background-color: #1a5490;
            color: white;
            padding: 12px;
            text-align: right;
        }
        td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: right;
        }
        tr:nth-child(even) {
            background-color: #f2f2f2;
        }
        code {
            background-color: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Consolas', 'Monaco', monospace;
            color: #c7254e;
        }
        .process-tree {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            padding: 20px;
            margin: 20px 0;
            font-family: monospace;
            direction: ltr;
            text-align: left;
        }
        ul.indicators {
            list-style: none;
            padding-right: 0;
        }
        ul.indicators li:before {
            content: "โ๏ธ ";
            margin-left: 10px;
        }
        .mitre-tag {
            display: inline-block;
            background-color: #e74c3c;
            color: white;
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
            margin: 0 5px;
        }
    </style>
</head>
<body>

<div class="container" dir="rtl" align="right">

<h1>๐ก๏ธ ุฑุงููุงูุง ุฌุงูุน ุชุญูู ูุฑุขูุฏูุง ุญุงุช ููุฏูุฒ ุจุฑุง ุดฺฉุงุฑ ุชูุฏุฏุงุช</h1>

<div class="info-box">
    <strong>๐ ุฏุฑุจุงุฑู ุงู ููุงูู:</strong><br>
    ุงู ููุงูู ุจุฎุด ุงุฒ ูุฌููุนู ุฑุงูููุงูุง ุนููุงุช <bdi dir="ltr">Threat Hunting</bdi> ุงุณุช ฺฉู ุจู ุชุญูู ุนูู ูุฑุขูุฏูุง ุณุณุชู ููุฏูุฒ ูโูพุฑุฏุงุฒุฏ. ูุฎุงุทุจุงู ุงู ููุงูู ุดุงูู ุชุญููฺฏุฑุงู <bdi dir="ltr">SOC</bdi>ุ ูุชุฎุตุตุงู <bdi dir="ltr">DFIR</bdi> (Digital Forensics & Incident Response) ู ุดฺฉุงุฑฺุงู ุชูุฏุฏ ูุณุชูุฏ.<br><br>
    <strong>๐ฏ ูุฏู:</strong> ุงุฑุงุฆู ุฑุงูููุง ุนูู ุจุฑุง ุดูุงุณุง ุฑูุชุงุฑูุง ูุฎุฑุจ ุฏุฑ ูุฑุขูุฏูุง ุญุงุช ููุฏูุฒ<br>
    <strong>๐ ุณุทุญ:</strong> ูพุดุฑูุชู (Advanced)<br>
    <strong>โฑ๏ธ ุฒูุงู ูุทุงูุนู:</strong> 35-40 ุฏููู
</div>

<h2>๐ ููุฏูู: ฺุฑุง ุดูุงุฎุช ุฑูุชุงุฑ ูุฑูุงู ุญุงุช ุงุณุชุ</h2>

<p>ฺฉ ุงุฒ ุงุตูู ุจูุงุฏู ุฏุฑ ุญูุฒู ุดฺฉุงุฑ ุชูุฏุฏุงุช ู ูพุงุณุฎ ุจู ุญูุงุฏุซุ ุดูุงุฎุช ุฏูู ู ุฌุงูุน ุงุฒ ุฑูุชุงุฑ ูุฑูุงู ฺฉ ุณุณุชู ุงุณุช. ุจุฏูู ุงู ุดูุงุฎุชุ ุชุดุฎุต ูุนุงูุชโูุง ุบุฑุนุงุฏ ู ูุฎุฑุจ ุชูุฑุจุงู ุบุฑููฺฉู ุฎูุงูุฏ ุจูุฏ. ููุงุฌูุงู ูพุดุฑูุชู (<bdi dir="ltr">APT Groups</bdi>) ุงุบูุจ ุจุง ุงุณุชูุงุฏู ุงุฒ ุชฺฉูฺฉโูุง ูพฺุฏูโุง ูุงููุฏ <bdi dir="ltr">Process Masquerading</bdi> <span class="mitre-tag">T1036</span>ุ <bdi dir="ltr">Process Hollowing</bdi> <span class="mitre-tag">T1055.012</span> ู <bdi dir="ltr">DLL Injection</bdi> <span class="mitre-tag">T1055.001</span> ุชูุงุด ูโฺฉููุฏ ุชุง ูุนุงูุชโูุง ูุฎุฑุจ ุฎูุฏ ุฑุง ุฏุฑ ูพูุดุด ูุฑุขูุฏูุง ูุดุฑูุน ุณุณุชู ูพููุงู ฺฉููุฏ.</p>

<p>ุจู ููู ุฏููุ ุขุดูุง ุจุง ูฺฺฏโูุง ุฏูู ูุฑุขูุฏูุง ุณุณุชู ููุฏูุฒุ ุฑูุงุจุท ูุงูุฏ-ูุฑุฒูุฏ ุขูโูุงุ ุญุณุงุจโูุง ฺฉุงุฑุจุฑ ฺฉู ุชุญุช ุขู ุงุฌุฑุง ูโุดููุฏ ู ุฒูุงูโุจูุฏ ุดุฑูุน ุขูโูุงุ ุจุฑุง ูุฑ ุชุญููฺฏุฑ ุงููุช ุถุฑูุฑ ุงุณุช.</p>

<h3>๐ ุขูฺู ุฏุฑ ุงู ููุงูู ุฎูุงูุฏ ุขููุฎุช:</h3>
<ul>
    <li>ุดูุงุฎุช ุนูู 9 ูุฑุขูุฏ ุญุงุช ููุฏูุฒ ู ุฑูุชุงุฑูุง ูุฑูุงู ุขูโูุง</li>
    <li>ุนูุงุฆู ูุดุฏุงุฑุฏููุฏู (<bdi dir="ltr">Indicators of Compromise</bdi>) ุจุฑุง ูุฑ ูุฑุขูุฏ</li>
    <li>ุชฺฉูฺฉโูุง ููุงุฌูุงู ุจุฑุง ุณูุกโุงุณุชูุงุฏู ุงุฒ ุงู ูุฑุขูุฏูุง</li>
    <li>ุฑูุดโูุง ุดูุงุณุง ู ูุธุงุฑุช ุจุง ุงุจุฒุงุฑูุง ุนููุงุช</li>
    <li>ููุงุท ูพุงุฏุงุฑ (<bdi dir="ltr">Persistence</bdi>) ููุฑุฏ ุงุณุชูุงุฏู ุจุฏุงูุฒุงุฑูุง</li>
</ul>

<h2>๐๏ธ ุฌุฏูู ุฎูุงุตู ูุฑุขูุฏูุง ุญุงุช ููุฏูุฒ</h2>

<table>
    <thead>
        <tr>
            <th>ูุฑุขูุฏ</th>
            <th>PID</th>
            <th>ูุงูุฏ</th>
            <th>ูุณุฑ</th>
            <th>ุญุณุงุจ ฺฉุงุฑุจุฑ</th>
            <th>ุชุนุฏุงุฏ ููููู</th>
            <th>Session</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><code>System</code></td>
            <td>4</td>
            <td>โ</td>
            <td><bdi dir="ltr">ntoskrnl.exe</bdi></td>
            <td><bdi dir="ltr">Local System</bdi></td>
            <td>1</td>
            <td>โ</td>
        </tr>
        <tr>
            <td><code>smss.exe</code></td>
            <td>ูุชุบุฑ</td>
            <td><code>System</code></td>
            <td><code>System32</code></td>
            <td><bdi dir="ltr">Local System</bdi></td>
            <td>1 (ูพุงุฏุงุฑ)</td>
            <td>โ</td>
        </tr>
        <tr>
            <td><code>csrss.exe</code></td>
            <td>ูุชุบุฑ</td>
            <td>ุชู (<code>smss.exe</code>)</td>
            <td><code>System32</code></td>
            <td><bdi dir="ltr">Local System</bdi></td>
            <td>โฅ2</td>
            <td>0, 1, ...</td>
        </tr>
        <tr>
            <td><code>wininit.exe</code></td>
            <td>ูุชุบุฑ</td>
            <td>ุชู (<code>smss.exe</code>)</td>
            <td><code>System32</code></td>
            <td><bdi dir="ltr">Local System</bdi></td>
            <td>1</td>
            <td>0</td>
        </tr>
        <tr>
            <td><code>services.exe</code></td>
            <td>ูุชุบุฑ</td>
            <td><code>wininit.exe</code></td>
            <td><code>System32</code></td>
            <td><bdi dir="ltr">Local System</bdi></td>
            <td>1</td>
            <td>0</td>
        </tr>
        <tr>
            <td><code>svchost.exe</code></td>
            <td>ูุชุบุฑ</td>
            <td><code>services.exe</code></td>
            <td><code>System32</code></td>
            <td>ูุชุบุฑ (System/Network/Local Service)</td>
            <td>50+</td>
            <td>0</td>
        </tr>
        <tr>
            <td><code>lsass.exe</code></td>
            <td>ูุชุบุฑ</td>
            <td><code>wininit.exe</code></td>
            <td><code>System32</code></td>
            <td><bdi dir="ltr">Local System</bdi></td>
            <td>1</td>
            <td>0</td>
        </tr>
        <tr>
            <td><code>winlogon.exe</code></td>
            <td>ูุชุบุฑ</td>
            <td>ุชู (<code>smss.exe</code>)</td>
            <td><code>System32</code></td>
            <td><bdi dir="ltr">Local System</bdi></td>
            <td>โฅ1</td>
            <td>1, 2, ...</td>
        </tr>
        <tr>
            <td><code>explorer.exe</code></td>
            <td>ูุชุบุฑ</td>
            <td>ุชู (<code>userinit.exe</code>)</td>
            <td><code>%SystemRoot%</code></td>
            <td>ุญุณุงุจ ฺฉุงุฑุจุฑ</td>
            <td>โฅ1</td>
            <td>1, 2, ...</td>
        </tr>
    </tbody>
</table>

<h2>๐ณ ูููุฏุงุฑ ุฏุฑุฎุช ูุฑุขูุฏูุง ุฑุงูโุงูุฏุงุฒ ููุฏูุฒ</h2>

<div class="process-tree">
System (PID: 4)
โ
โโโ Memory Compression (Win10+)
โ
โโโ smss.exe (Session Manager)
    โ
    โโโ [Child] smss.exe (Session 0) โ Exits after spawning:
    โ   โโโ csrss.exe (Session 0)
    โ   โโโ wininit.exe
    โ       โโโ services.exe (Service Control Manager)
    โ       โ   โโโ svchost.exe (Instance 1 - DcomLaunch)
    โ       โ   โโโ svchost.exe (Instance 2 - RPCSS)
    โ       โ   โโโ svchost.exe (Instance 3 - netsvcs)
    โ       โ   โโโ ... (50+ instances)
    โ       โ   โโโ spoolsv.exe
    โ       โ   โโโ SearchIndexer.exe
    โ       โ
    โ       โโโ lsass.exe (Local Security Authority)
    โ       โ   โโโ lsaiso.exe (if Credential Guard enabled)
    โ       โ
    โ       โโโ fontdrvhost.exe
    โ
    โโโ [Child] smss.exe (Session 1) โ Exits after spawning:
        โโโ csrss.exe (Session 1)
        โโโ winlogon.exe
            โโโ LogonUI.exe
            โโโ dwm.exe (Desktop Window Manager)
            โโโ fontdrvhost.exe
            โโโ userinit.exe โ Exits after spawning:
                โโโ explorer.exe (User Shell)
                    โโโ [User Applications]
                    โโโ cmd.exe (if user launches)
                    โโโ powershell.exe (if user launches)
                    โโโ ...
</div>

<h2>๐ ุจุฎุด ุงูู: ุชุญูู ุนูู ูุฑุขูุฏูุง ุญุงุช ููุฏูุฒ</h2>

<h3>1๏ธโฃ ูุฑุขูุฏ <bdi dir="ltr">System</bdi> ู <bdi dir="ltr">Memory Compression</bdi></h3>

<p>ูุฑุขูุฏ <b><bdi dir="ltr">System</bdi></b> ุจุง ุดูุงุณู ูุฑุขูุฏ (<bdi dir="ltr">PID</bdi>) ุซุงุจุช <strong>4</strong>ุ ฺฉ ูุฑุขูุฏ ูฺู ุฏุฑ ูุนูุงุฑ ููุฏูุฒ ุงุณุช ฺฉู ูุฒุจุงู ุชูุงู ุชุฑุฏโูุง ุญุงูุช ูุณุชู (<bdi dir="ltr">Kernel Mode Threads</bdi>) ูโุจุงุดุฏ. ุงู ูุฑุขูุฏ ุฏุฑ ูุงูุน ฺฉ ูุฑุขูุฏ ูุงูุน ุฏุฑ ูุถุง ฺฉุงุฑุจุฑ (<bdi dir="ltr">User Space</bdi>) ูุณุชุ ุจูฺฉู ููุงุด ุงุฒ ูุนุงูุชโูุง ูุณุชู ุณุณุชูโุนุงูู ุฏุฑ ุงุจุฒุงุฑูุง ูุงููุฏ <bdi dir="ltr">Task Manager</bdi> ู <bdi dir="ltr">Process Explorer</bdi> ุงุณุช.</p>

<div class="info-box">
    <strong>๐ ูฺฺฏโูุง ฺฉูุฏ:</strong>
    <ul>
        <li><strong>PID:</strong> ููุดู 4 (ุซุงุจุช)</li>
        <li><strong>ูุงูุฏ:</strong> ูุฏุงุฑุฏ (ุฑุดู ุฏุฑุฎุช ูุฑุขูุฏูุง)</li>
        <li><strong>ูุฑุฒูุฏ:</strong> ุชููุง <code>smss.exe</code></li>
        <li><strong>ูุณุฑ ููุงุด:</strong> <code>ntoskrnl.exe</code> (ุฏุฑ <bdi dir="ltr">Task Manager</bdi>) ุง <bdi dir="ltr">"None"</bdi> (ุฏุฑ <bdi dir="ltr">Process Explorer</bdi>)</li>
        <li><strong>ุญุณุงุจ ฺฉุงุฑุจุฑ:</strong> <bdi dir="ltr">Local System</bdi></li>
    </ul>
</div>

<p>ฺฉ ุงุฒ ูุฑุขูุฏูุง ูุฑุชุจุท ฺฉู ุฏุฑ ูุณุฎูโูุง ุฌุฏุฏ ููุฏูุฒ (ุงุฒ ููุฏูุฒ 10 ุจู ุจุนุฏ) ุงุถุงูู ุดุฏูุ ูุฑุขูุฏ <b><bdi dir="ltr">Memory Compression</bdi></b> ุงุณุช. ุงู ูุฑุขูุฏ ฺฉ ูุฑุขูุฏ ูููุงู ุงุณุช ฺฉู ูุธูู ูุดุฑุฏูโุณุงุฒ ุญุงูุธู ูุฑุขูุฏูุง ุฏุฑ <bdi dir="ltr">RAM</bdi> ุฑุง ุจุฑ ุนูุฏู ุฏุงุฑุฏ ุชุง ุจู ุฌุง ุตูุญูโุจูุฏ (<bdi dir="ltr">Paging</bdi>) ุฏุงุฏูโูุง ุจู ุฏุณฺฉุ ุนููฺฉุฑุฏ ู ุฒูุงู ูพุงุณุฎโุฏู ุณุณุชู ุฑุง ุจูุจูุฏ ุจุฎุดุฏ. ูุงูุฏ ุงู ูุฑุขูุฏ <bdi dir="ltr">System</bdi> ุงุณุช ู ูฺ ูุฑุขูุฏ ูุฑุฒูุฏ ูุฏุงุฑุฏ. ุงู ูุฑุขูุฏ ุชุญุช ุญุณุงุจ ฺฉุงุฑุจุฑ <bdi dir="ltr">Local System</bdi> ุงุฌุฑุง ูโุดูุฏ ู ุชููุง ฺฉ ููููู ุงุฒ ุขู ุฏุฑ ุณุณุชู ูุฌูุฏ ุฏุงุฑุฏ.</p>

<div class="warning-box">
    <strong>โ๏ธ ูุดุฏุงุฑ ุจุฑุง ุชุญููฺฏุฑุงู:</strong><br>
    ุงุฒ ุขูุฌุง ฺฉู <bdi dir="ltr">Memory Compression</bdi> ูุณุจุชุงู ุฌุฏุฏ ุงุณุชุ ุจุฑุฎ ุชุญููฺฏุฑุงู ููฺฉู ุงุณุช ุจุง ุขู ุขุดูุง ูุจุงุดูุฏ ู ุขู ุฑุง ุจู ุงุดุชุจุงู ูุดฺฉูฺฉ ุชูู ฺฉููุฏ. ุงู ูุฑุขูุฏ ฺฉุงููุงู ูุดุฑูุน ุงุณุช.
</div>

<div class="danger-box">
    <strong>๐จ ุนูุงุฆู ูุดุฏุงุฑุฏููุฏู (<bdi dir="ltr">IoCs</bdi>):</strong>
    <ul class="indicators">
        <li>ูุฌูุฏ ูุฑุขูุฏ ูุฑุฒูุฏ ุบุฑ ุงุฒ <code>smss.exe</code> ุจุฑุง <bdi dir="ltr">System</bdi></li>
        <li><bdi dir="ltr">PID</bdi> ูุชูุงูุช ุงุฒ 4</li>
        <li>ูุฑฺฏููู ุชูุงุด ุจุฑุง ุงุฌุฑุง ูุงู ุจุง ูุงู <code>ntoskrnl.exe</code> ุงุฒ ูุณุฑูุง ุบุฑุนุงุฏ</li>
    </ul>
</div>

<h3>2๏ธโฃ <bdi dir="ltr">Session Manager Subsystem</bdi> (<code>smss.exe</code>)</h3>

<p>ูุฑุขูุฏ <b><code>smss.exe</code></b> ุงููู ูุฑุขูุฏ ุญุงูุช ฺฉุงุฑุจุฑ (<bdi dir="ltr">User Mode</bdi>) ุฏุฑ ููุฏูุฒ ุงุณุช ฺฉู ุชูุณุท ูุฑุขูุฏ <bdi dir="ltr">System</bdi> ุงุฌุงุฏ ูโุดูุฏ. ุงู ูุฑุขูุฏ ููุด ุจุณุงุฑ ุญุงุช ุฏุฑ ุฑุงูโุงูุฏุงุฒ ุณุณุชู ุฏุงุฑุฏ ู ูุณุฆููุชโูุง ูุชุนุฏุฏ ุฑุง ุจุฑ ุนูุฏู ุฏุงุฑุฏ.</p>

<div class="info-box">
    <strong>๐ ูุธุงู ฺฉูุฏ:</strong>
    <ul>
        <li>ุงุฌุงุฏ ูุชุบุฑูุง ูุญุท (<bdi dir="ltr">Environment Variables</bdi>)</li>
        <li>ุงุฌุงุฏ ุชูุตูฺฏุฑูุง ุงููุช (<bdi dir="ltr">Security Descriptors</bdi>)</li>
        <li>ููุฏุงุฑุฏู ุงููู ุฑุฌุณุชุฑ (ุจู ูฺู ูุงููุง <code>HKLM\Software</code>ุ <code>SAM</code> ู <code>Security</code>)</li>
        <li>ุงุฌุงุฏ ู ูุฏุฑุช ูุดุณุชโูุง ฺฉุงุฑุจุฑ (<bdi dir="ltr">Sessions</bdi>)</li>
    </ul>
</div>

<p><strong>ูุณุฑ ุงุฌุฑุง:</strong> <code>%SystemRoot%\System32\smss.exe</code><br>
<strong>ูุงูุฏ:</strong> ูุฑุขูุฏ <bdi dir="ltr">System</bdi></p>

<h4>๐ ูฺฉุงูุฒู ุฑุงูโุงูุฏุงุฒ:</h4>

<p>ูฺฉุชู ููู ุฏุฑ ููุฑุฏ ุงู ูุฑุขูุฏ ุงู ุงุณุช ฺฉู ฺฉ <strong>ููููู ุงุตู</strong> (<bdi dir="ltr">Master Instance</bdi>) ุงุฒ ุขู ูุฌูุฏ ุฏุงุฑุฏ ฺฉู ูพุณ ุงุฒ ุจูุช ุณุณุชู ุจุงู ูโูุงูุฏ ู ูุดุฎุตู ุงุตู ุขู <strong>ุนุฏู ูุฌูุฏ ุขุฑฺฏููุงู ุฎุท ูุฑูุงู</strong> (<bdi dir="ltr">Command Line Arguments</bdi>) ุงุณุช.</p>

<p>ุงู ููููู ุงุตู ุญุฏุงูู ุฏู ููููู ูุฑุฒูุฏ ุงุฒ ุฎูุฏ ุงุฌุงุฏ ูโฺฉูุฏ:</p>

<ol>
    <li><strong>ููููู <bdi dir="ltr">Session 0</bdi>:</strong> ูุณุฆูู ุงุฌุงุฏ ูุฑุขูุฏูุง <code>csrss.exe</code> ู <code>wininit.exe</code> (ุณุฑูุณโูุง ุณุณุชู)</li>
    <li><strong>ููููู <bdi dir="ltr">Session 1</bdi>:</strong> ูุณุฆูู ุงุฌุงุฏ ูุฑุขูุฏูุง <code>csrss.exe</code> ู <code>winlogon.exe</code> (ุงููู ฺฉุงุฑุจุฑ ุชุนุงูู)</li>
</ol>

<div class="warning-box">
    <strong>โก ูฺฉุชู ููู:</strong><br>
    ูพุณ ุงุฒ ุงุชูุงู ูุธุงู ุฎูุฏุ ุชูุงู ูุฑุขูุฏูุง ูุฑุฒูุฏ <code>smss.exe</code> ุฎุงุชูู ูโุงุจูุฏ ู ุชููุง ููููู ุงุตู (ุจุฏูู ุขุฑฺฏููุงู) ุจุงู ูโูุงูุฏ.
</div>

<div class="danger-box">
    <strong>๐จ ุนูุงุฆู ูุดุฏุงุฑุฏููุฏู (<bdi dir="ltr">IoCs</bdi>):</strong>
    <ul class="indicators">
        <li>ูุฌูุฏ ุจุด ุงุฒ ฺฉ ููููู ูพุงุฏุงุฑ ุงุฒ <code>smss.exe</code> ุจุฏูู ุขุฑฺฏููุงู</li>
        <li>ูุงูุฏ ุบุฑ ุงุฒ <bdi dir="ltr">System</bdi> (PID โ 4)</li>
        <li>ูุณุฑ ุงุฌุฑุง ูุชูุงูุช ุงุฒ <code>%SystemRoot%\System32\</code></li>
        <li>ูุงูโูุง ูุดุงุจู: <code>smsss.exe</code> (ุจุง 3 ุญุฑู s)ุ <code>smss32.exe</code>ุ <code>smss.com</code></li>
        <li>ุงุฌุฑุง ุชุญุช ุญุณุงุจ ฺฉุงุฑุจุฑ ุบุฑ ุงุฒ <bdi dir="ltr">Local System</bdi></li>
    </ul>
</div>

<div class="info-box">
    <strong>๐ ุฑูุด ุดูุงุณุง:</strong>
    <pre><code># PowerShell Command
Get-Process smss | Select-Object Id, Parent, Path, CommandLine

# Sysmon Event ID 1 Query
EventCode=1 Image="*\\smss.exe" ParentImage!="*\\System"</code></pre>
</div>

<h3>Client/Server Runtime Subsystem (csrss.exe)</h3>

<p>ูุฑุขูุฏ <b>csrss.exe</b> ฺฉ ูุฑุขูุฏ ุญุงุช ุฏุฑ ูุนูุงุฑ ููุฏูุฒ ุงุณุช ฺฉู ุฒุฑุณุณุชู ููุฏูุฒ ุฑุง ุฏุฑ ุญุงูุช ฺฉุงุฑุจุฑ ูพุงุฏูโุณุงุฒ ูโฺฉูุฏ. ุงู ูุฑุขูุฏ ูุธุงู ูุชุนุฏุฏ ุงุฒ ุฌููู ูุฏุฑุช ูุฑุขูุฏูุง ู ุชุฑุฏโูุงุ ูุงุฑุฏ ฺฉุฑุฏู ุจุณุงุฑ ุงุฒ DLLูุง ฺฉู Windows API ุฑุง ูุฑุงูู ูโฺฉููุฏุ ู ุชุณูู ุฎุงููุด ุดุฏู GUI ุฏุฑ ุญู shutdown ุณุณุชู ุฑุง ุจุฑ ุนูุฏู ุฏุงุฑุฏ. ูุณุฑ ุงุฌุฑุง ุขู <code>%SystemRoot%\System32\csrss.exe</code> ุงุณุช ู ุชุญุช ุญุณุงุจ ฺฉุงุฑุจุฑ Local System ุงุฌุฑุง ูโุดูุฏ.</p>

<p>ูฺฉุชู ููู ุฏุฑ ููุฑุฏ ุงู ูุฑุขูุฏ ุงู ุงุณุช ฺฉู ูุงูุฏ ุขู ฺฉ ููููู ูุฑุฒูุฏ ุงุฒ <code>smss.exe</code> ุงุณุช ฺฉู ูพุณ ุงุฒ ุงุฌุงุฏ <code>csrss.exe</code> ุฎุงุชูู ูโุงุจุฏุ ุจูุงุจุฑุงู <code>csrss.exe</code> ุจู ุนููุงู ฺฉ ูุฑุขูุฏ ุชู (Orphan Process) ุธุงูุฑ ูโุดูุฏ. ุจุฑุง ูุฑ ูุดุณุช ฺฉุงุฑุจุฑ (Session) ฺฉ ููููู ุงุฒ <code>csrss.exe</code> ูุฌูุฏ ุฏุงุฑุฏุ ุจูุงุจุฑุงู ุฏุฑ ฺฉ ุณุณุชู ูุนููู ุญุฏุงูู ุฏู ููููู ุงุฒ ุงู ูุฑุขูุฏ ุจุงุฏ ูุฌูุฏ ุฏุงุดุชู ุจุงุดุฏ: ฺฉ ุจุฑุง Session 0 (ุณุฑูุณโูุง ุณุณุชู) ู ฺฉ ุจุฑุง Session 1 (ุงููู ฺฉุงุฑุจุฑ ุชุนุงูู). ุฏุฑ ุตูุฑุช ุงุณุชูุงุฏู ุงุฒ Remote Desktop ุง Fast User Switchingุ ูุดุณุชโูุง ุจุดุชุฑ ุงุฌุงุฏ ูโุดูุฏ ู ุฏุฑ ูุชุฌู ูููููโูุง ุจุดุชุฑ ุงุฒ <code>csrss.exe</code> ุฎูุงูู ุฏุงุดุช.</p>

<p>ุงุฒ ูุธุฑ ุงููุชุ <code>csrss.exe</code> ูุฑฺฏุฒ ูุจุงุฏ ูุฑุขูุฏ ูุฑุฒูุฏ ุฏุงุดุชู ุจุงุดุฏ. ุงฺฏุฑ ุงู ูุฑุขูุฏ ูุฑุขูุฏ ูุฑุฒูุฏ ุฏุงุดุชู ุจุงุดุฏุ ุง ูุงูุฏ ุขู ฺฉ ูุฑุขูุฏ ูุนุงู ุจุงุดุฏ (ูู ุชู)ุ ุง ูุณุฑ ุงุฌุฑุง ุขู ูุชูุงูุช ุงุฒ <code>System32</code> ุจุงุดุฏุ ุงู ููุงุฑุฏ ุนูุงุฆู ุฌุฏ ูููุฐ ูุณุชูุฏ. ููุงุฌูุงู ุงุบูุจ ุณุน ูโฺฉููุฏ ุจุฏุงูุฒุงุฑูุง ุจุง ูุงูโูุง ูุดุงุจู ูุงููุฏ <code>csrsss.exe</code> ุง <code>cssrss.exe</code> ุงุฌุงุฏ ฺฉููุฏ ุง ุงุฒ ุชฺฉูฺฉ Process Hollowing ุจุฑุง ุชุฒุฑู ฺฉุฏ ูุฎุฑุจ ุจู ูุฑุขูุฏ ูุดุฑูุน <code>csrss.exe</code> ุงุณุชูุงุฏู ฺฉููุฏ.</p>

<h3>Windows Initialization Process (wininit.exe)</h3>

<p>ูุฑุขูุฏ <b>wininit.exe</b> ูุณุฆูู ููุฏุงุฑุฏู ุงููู ู ุฑุงูโุงูุฏุงุฒ ุจุณุงุฑ ุงุฒ ุงุฌุฒุง ุญุงุช ุณุณุชู ุงุณุช. ุงู ูุฑุขูุฏ ูุชุบุฑูุง ูุญุท ูพุดโูุฑุถ (USERPROFILEุ ALLUSERPROFILEุ PUBLIC ู ProgramData) ุฑุง ุชูุธู ูโฺฉูุฏุ ูุฑุขูุฏ LSASS ุฑุง ุงุฌุงุฏ ฺฉุฑุฏู ู ฺฉูุฏ ุฑูุฒูฺฏุงุฑ LSA ุฑุง ุชูุธู ูโฺฉูุฏุ Service Control Manager ุฑุง ุจุง ุฑุงูโุงูุฏุงุฒ ูุฑุขูุฏ <code>services.exe</code> ุงุฌุงุฏ ูโฺฉูุฏ ู ุฏุงุฑฺฉุชูุฑ ูููุช ุฏุฑ ุฑุดู ุณุณุชู (<code>%SystemRoot%\Temp</code>) ุฑุง ุงุฌุงุฏ ูโฺฉูุฏ.</p>

<p>ูุณุฑ ุงุฌุฑุง ุงู ูุฑุขูุฏ <code>%SystemRoot%\System32\wininit.exe</code> ุงุณุช ู ูุงูุฏ ุขู ฺฉ ููููู ูุฑุฒูุฏ ุงุฒ <code>smss.exe</code> ุฏุฑ Session 0 ุงุณุช ฺฉู ูพุณ ุงุฒ ุงุฌุงุฏ <code>wininit.exe</code> ุฎุงุชูู ุงูุชู ู ุจูุงุจุฑุงู <code>wininit.exe</code> ูุฒ ุจู ุนููุงู ฺฉ ูุฑุขูุฏ ุชู ุธุงูุฑ ูโุดูุฏ. ุงู ูุฑุขูุฏ ุชุญุช ุญุณุงุจ ฺฉุงุฑุจุฑ Local System ุงุฌุฑุง ูโุดูุฏ ู ุชููุง ฺฉ ููููู ุงุฒ ุขู ุฏุฑ ุณุณุชู ูุฌูุฏ ุฏุงุฑุฏ. ูุฑุขูุฏูุง ูุฑุฒูุฏ ุงู ูุฑุขูุฏ ุนุจุงุฑุชูุฏ ุงุฒ <code>services.exe</code>ุ <code>lsass.exe</code> ู <code>fontdrvhost.exe</code>.</p>

<p>ุงุฒ ูุธุฑ ุงููุชุ ูุฌูุฏ ุจุด ุงุฒ ฺฉ ููููู ุงุฒ <code>wininit.exe</code>ุ ุง ุฏุงุดุชู ูุงูุฏ ฺฉู ฺฉ ูุฑุขูุฏ ูุนุงู ุจุงุดุฏุ ุง ูุณุฑ ุงุฌุฑุง ูุชูุงูุชุ ููฺฏ ูุดุงููโูุง ูุดุฏุงุฑุฏููุฏู ูุณุชูุฏ. ููฺููุ ุงฺฏุฑ ูุฑุขูุฏูุง ูุฑุฒูุฏ ุงูุชุธุงุฑ ุฑูุชู (<code>services.exe</code>ุ <code>lsass.exe</code>ุ <code>fontdrvhost.exe</code>) ูุฌูุฏ ูุฏุงุดุชู ุจุงุดูุฏ ุง ูุฑุขูุฏูุง ูุฑุฒูุฏ ุบุฑูุนููู ุฏฺฏุฑ ูุฌูุฏ ุฏุงุดุชู ุจุงุดูุฏุ ุงู ููุงุฑุฏ ูุฒ ูโุชูุงููุฏ ูุดุงูฺฏุฑ ฺฉ ูููุฐ ุจุงุดูุฏ.</p>

<h3>Service Control Manager (services.exe)</h3>

<p>ูุฑุขูุฏ <b>services.exe</b> ฺฉู ุจู ุนููุงู Service Control Manager (SCM) ุดูุงุฎุชู ูโุดูุฏุ ฺฉ ุงุฒ ุญุงุชโุชุฑู ุงุฌุฒุง ุณุณุชูโุนุงูู ููุฏูุฒ ุงุณุช. ุงู ูุฑุขูุฏ ูุณุฆูู ูุฏุฑุช ฺฉุงูู ุณุฑูุณโูุง ุณุณุชู ุงุณุชุ ุงุฒ ุฌููู ุดุฑูุนุ ุชูููุ ูุชููู ฺฉุฑุฏู ูููุช ู ุงุฏุงูู ุฏุงุฏู ุณุฑูุณโูุง. ุณุฑูุณโูุง ุฏุฑ ฺฉูุฏ ุฑุฌุณุชุฑ <code>HKLM\SYSTEM\CurrentControlSet\Services\</code> ุชุนุฑู ูโุดููุฏ ู SCM ุงู ุชุนุงุฑู ุฑุง ุฎูุงูุฏู ู ุจุฑ ุงุณุงุณ ุชูุธูุงุช ุขูโูุง ุนูู ูโฺฉูุฏ.</p>

<p>ูุณุฑ ุงุฌุฑุง ุงู ูุฑุขูุฏ <code>%SystemRoot%\System32\services.exe</code> ุงุณุชุ ูุงูุฏ ุขู <code>wininit.exe</code> ูโุจุงุดุฏ ู ุชุญุช ุญุณุงุจ ฺฉุงุฑุจุฑ Local System ุงุฌุฑุง ูโุดูุฏ. ุชููุง ฺฉ ููููู ุงุฒ ุงู ูุฑุขูุฏ ุฏุฑ ุณุณุชู ูุฌูุฏ ุฏุงุฑุฏ. ุงู ูุฑุขูุฏ ูุงูุฏ ุจุณุงุฑ ุงุฒ ูุฑุขูุฏูุง ุฏฺฏุฑ ุงุณุชุ ุงุฒ ุฌููู ุชูุงู ูููููโูุง <code>svchost.exe</code>ุ <code>spoolsv.exe</code>ุ <code>SearchIndexer.exe</code> ู ูุฑ ุณุฑูุณ ุฏฺฏุฑ ฺฉู ุจู ุตูุฑุช ูุณุชูู ุงุฌุฑุง ูโุดูุฏ.</p>

<p>ฺฉ ุงุฒ ูฺฉุงุช ููู ุฏุฑ ููุฑุฏ SCM ุงู ุงุณุช ฺฉู ุงู ูุฑุขูุฏ <b>Unified Background Process Manager (UBPM)</b> ุฑุง ูุฒ ูพุงุฏูโุณุงุฒ ูโฺฉูุฏ ฺฉู ูุณุฆูู ูุนุงูุชโูุง ูพุณโุฒููู ูุงููุฏ ุณุฑูุณโูุง ู ูุธุงู ุฒูุงูโุจูุฏ ุดุฏู ุงุณุช. ุนูุงูู ุจุฑ ุงูุ ูพุณ ุงุฒ ูุฑูุฏ ููููุชโุขูุฒ ุชุนุงูู ฺฉ ฺฉุงุฑุจุฑุ SCM ุจูุช ุฑุง ูููู ุชูู ฺฉุฑุฏู ู ููุฏุงุฑ Last Known Good control set ุฑุง ุฏุฑ <code>HKLM\SYSTEM\Select\LastKnownGood</code> ุจู ููุฏุงุฑ CurrentControlSet ุชูุธู ูโฺฉูุฏ.</p>

<p>ุงุฒ ูุธุฑ ุงููุชุ ูุฌูุฏ ุจุด ุงุฒ ฺฉ ููููู ุงุฒ <code>services.exe</code>ุ ุง ูุงูุฏ ุบุฑ ุงุฒ <code>wininit.exe</code>ุ ุง ุงุฌุฑุง ุชุญุช ุญุณุงุจ ฺฉุงุฑุจุฑ ุบุฑ ุงุฒ Local Systemุ ููฺฏ ุนูุงุฆู ุฌุฏ ูููุฐ ูุณุชูุฏ. ููฺููุ ุงฺฏุฑ ูุฑุขูุฏูุง ูุฑุฒูุฏ ุบุฑูุนููู ฺฉู ุณุฑูุณ ุดูุงุฎุชู ุดุฏูโุง ูุณุชูุฏ ูุฌูุฏ ุฏุงุดุชู ุจุงุดูุฏุ ุงู ููุงุฑุฏ ูุฒ ุจุงุฏ ููุฑุฏ ุจุฑุฑุณ ุฏูู ูุฑุงุฑ ฺฏุฑูุฏ.</p>

<h3>Generic Host Process for Services (svchost.exe)</h3>

<p>ูุฑุขูุฏ <b>svchost.exe</b> ฺฉ ุงุฒ ุดูุงุฎุชูโุดุฏูโุชุฑู ู ุฏุฑ ุนู ุญุงู ูพฺุฏูโุชุฑู ูุฑุขูุฏูุง ููุฏูุฒ ุงุณุช. ุงู ูุฑุขูุฏ ฺฉ ูุฒุจุงู ุนููู ุจุฑุง ุณุฑูุณโูุง ุงุณุช ฺฉู ุจู ุตูุฑุช DLL ูพุงุฏูโุณุงุฒ ุดุฏูโุงูุฏ. ุจู ุฏูู ฺฉุงูุด ูุตุฑู ููุงุจุน ุณุณุชูุ ููุฏูุฒ ุจุณุงุฑ ุงุฒ ุณุฑูุณโูุง ุฎูุฏ ุฑุง ุจู ุตูุฑุช DLL ูพุงุฏูโุณุงุฒ ฺฉุฑุฏู ู ุขูโูุง ุฑุง ุฏุฑ ูููููโูุง ูุฎุชูู <code>svchost.exe</code> ุงุฌุฑุง ูโฺฉูุฏ.</p>

<p>ูุณุฑ ุงุฌุฑุง ุงู ูุฑุขูุฏ <code>%SystemRoot%\System32\svchost.exe</code> ุงุณุชุ ูุงูุฏ ุขู <code>services.exe</code> ูโุจุงุดุฏ ู ูโุชูุงูุฏ ุชุญุช ุญุณุงุจโูุง ฺฉุงุฑุจุฑ ูุฎุชูู ุงุฒ ุฌููู Local Systemุ Network Serviceุ Local Service ู ุญุช ุญุณุงุจโูุง ฺฉุงุฑุจุฑ ูุนููู ุงุฌุฑุง ุดูุฏ. ุชุนุฏุงุฏ ูููููโูุง ุงู ูุฑุขูุฏ ุจุณุงุฑ ุฒุงุฏ ุงุณุช ู ูุนูููุงู ุจู 10 ุชุง 100 ุง ุญุช ุจุดุชุฑ ููููู ุฏุฑ ฺฉ ุณุณุชู ูุนููู ูุฌูุฏ ุฏุงุฑุฏ.</p>

<p>ูฺฉุชู ุจุณุงุฑ ููู ุฏุฑ ููุฑุฏ <code>svchost.exe</code> ุงู ุงุณุช ฺฉู ุงู ูุฑุขูุฏ ููุดู ุจุงุฏ ุจุง ูพุงุฑุงูุชุฑ <code>-k</code> ุงุฌุฑุง ุดูุฏ ฺฉู Service Host Groups ุฑุง ุฏุฑ ุฑุฌุณุชุฑ ูุดุฎุต ูโฺฉูุฏ. ฺฏุฑููโูุง ูุนููู ุดุงูู DcomLaunchุ RPCSSุ LocalServiceุ netsvcsุ NetworkService ู UnistackSvcGroup ูุณุชูุฏ. ูพุงุฑุงูุชุฑ <code>-s</code> ูุงู ุณุฑูุณ ุฎุงุต ุฑุง ูุดุฎุต ูโฺฉูุฏ (ูุงููุฏ LanmanServerุ WinRM ุง Winmgmt) ู ูพุงุฑุงูุชุฑ <code>-p</code> ูุดุงูโุฏููุฏู ุงุฌุฑุง ุณุงุณุช (Policy Enforcement) ุงุณุช.</p>

<p>ฺฉ ุงุฒ ุชุบุฑุงุช ููู ุฏุฑ ููุฏูุฒ 10 ูุณุฎู 1703 ุงู ุจูุฏ ฺฉู ูุงฺฉุฑูุณุงูุช ฺฏุฑููโุจูุฏ ูพุดโูุฑุถ ุณุฑูุณโูุง ูุดุงุจู ุฑุง ุจุฑุง ุณุณุชูโูุง ุจุง ุจุด ุงุฒ 3.5 ฺฏฺฏุงุจุงุช RAM ุชุบุฑ ุฏุงุฏ. ุฏุฑ ุงู ุณุณุชูโูุงุ ุงฺฉุซุฑ ุณุฑูุณโูุง ุงฺฉููู ุชุญุช ููููู ูุณุชูู ุฎูุฏ ุงุฒ <code>svchost.exe</code> ุงุฌุฑุง ูโุดููุฏ ฺฉู ููุฌุฑ ุจู ูุฌูุฏ ุจุด ุงุฒ 50 ููููู ุงุฒ ุงู ูุฑุขูุฏ ูโุดูุฏ. ุงู ุชุบุฑ ุจุฑุง ุงูุฒุงุด ูุงุจูุช ุงุทููุงู ู ุงููุช ุงูุฌุงู ุดุฏู ุงุณุชุ ุฒุฑุง ูุดฺฉู ุฏุฑ ฺฉ ุณุฑูุณ ุฏฺฏุฑ ุณุฑูุณโูุง ุฑุง ุชุญุช ุชุฃุซุฑ ูุฑุงุฑ ููโุฏูุฏ.</p>

<p>ุงุฒ ูุธุฑ ุงููุชุ <code>svchost.exe</code> ฺฉ ูุฏู ูุญุจูุจ ุจุฑุง ููุงุฌูุงู ุงุณุช. ุนูุงุฆู ูุดุฏุงุฑุฏููุฏู ุดุงูู ูุงูุฏ ุบุฑ ุงุฒ <code>services.exe</code>ุ ุงุฌุฑุง ุจุฏูู ูพุงุฑุงูุชุฑ <code>-k</code>ุ ูุณุฑ ุงุฌุฑุง ูุดฺฉูฺฉ (ูุงููุฏ <code>svch0st.exe</code> ุจุง ุตูุฑ ุจู ุฌุง ุญุฑู o)ุ ุงุฌุฑุง ุชุญุช ุญุณุงุจ ฺฉุงุฑุจุฑ ุบุฑูุนูููุ ุง ูุตุฑู ููุงุจุน ุบุฑุนุงุฏ (CPU ุง ุดุจฺฉู) ูุณุชูุฏ. ุชุญููฺฏุฑุงู ุจุงุฏ ุจุง ุงุณุชูุงุฏู ุงุฒ ุงุจุฒุงุฑูุง ูุงููุฏ Process Explorerุ ุณุฑูุณโูุง ุฏุฑ ุญุงู ุงุฌุฑุง ุฏุฑ ูุฑ ููููู <code>svchost.exe</code> ุฑุง ุจุฑุฑุณ ฺฉููุฏ ู ูุฑฺฏููู ุณุฑูุณ ูุงุดูุงุฎุชู ุง ูุดฺฉูฺฉ ุฑุง ุดูุงุณุง ููุงูุฏ.</p>

<h3>Local Security Authority Subsystem (lsass.exe)</h3>

<p>ูุฑุขูุฏ <b>lsass.exe</b> ฺฉ ุงุฒ ุญุณุงุณโุชุฑู ู ุญุงุชโุชุฑู ูุฑุขูุฏูุง ุงููุช ุฏุฑ ููุฏูุฒ ุงุณุช. ุงู ูุฑุขูุฏ ูุณุฆูู ูุฏุฑุช ุงุญุฑุงุฒ ููุช ุฏุฑ ุณุณุชู ุงุณุช ู ูุธุงู ูุชุนุฏุฏ ุงุฒ ุฌููู ูุฑุงุฎูุงู ุจุณุชู ุงุญุฑุงุฒ ููุช ููุงุณุจ (ูุนูููุงู Kerberos ุจุฑุง ุญุณุงุจโูุง ุฏุงููู ุง MSV1_0 ุจุฑุง ุญุณุงุจโูุง ูุญู)ุ ุงุฌุฑุง ุณุงุณุชโูุง ุงููุช ูุญู (ูุงููุฏ ุณุงุณุชโูุง ุฑูุฒ ุนุจูุฑ ู ุณุงุณุชโูุง ููุฒ) ู ููุดุชู ุฑูุฏุงุฏูุง ุฏุฑ ูุงฺฏ ุงููุช ุฑุง ุจุฑ ุนูุฏู ุฏุงุฑุฏ.</p>

<p>ูุณุฑ ุงุฌุฑุง ุงู ูุฑุขูุฏ <code>%SystemRoot%\System32\lsass.exe</code> ุงุณุชุ ูุงูุฏ ุขู <code>wininit.exe</code> ูโุจุงุดุฏ ู ุชุญุช ุญุณุงุจ ฺฉุงุฑุจุฑ Local System ุงุฌุฑุง ูโุดูุฏ. ุชููุง ฺฉ ููููู ุงุฒ ุงู ูุฑุขูุฏ ุฏุฑ ุณุณุชู ูุฌูุฏ ุฏุงุฑุฏ ู ุงู ูุฑุขูุฏ ุจู ูุฏุฑุช ูุฑุขูุฏ ูุฑุฒูุฏ ุฏุงุฑุฏ (ุจู ุงุณุชุซูุง ููุงุฑุฏ ูุงููุฏ Encrypting File System ฺฉู ฺฉ ุงุณุชุซูุง ุดูุงุฎุชู ุดุฏู ุงุณุช).</p>

<p>ฺฉ ุงุฒ ูฺฉุงุช ููู ฺฉู ุฏุฑ ูพูุณุชุฑ ุงุตู ุจู ุขู ุงุดุงุฑู ูุดุฏู ุจูุฏุ ูุฌูุฏ ูุฑุขูุฏ <b>lsaiso.exe</b> ุฏุฑ ุณุณุชูโูุง ุงุณุช ฺฉู Virtualization-Based Security (VBS) ู Credential Guard ูุนุงู ุดุฏูโุงูุฏ. ุฒูุงู ฺฉู VBS ูุนุงู ุจุงุดุฏุ ุนููฺฉุฑุฏ <code>lsass.exe</code> ุจู ุฏู ูุฑุขูุฏ ุชูุณู ูโุดูุฏ: ุฎูุฏ <code>lsass.exe</code> ู <code>lsaiso.exe</code>. ุงฺฉุซุฑ ุนููฺฉุฑุฏูุง ุฏุฑ <code>lsass.exe</code> ุจุงู ูโูุงููุฏุ ุงูุง ููุด ููู ุฐุฎุฑูโุณุงุฒ ุงูู ุงุนุชุจุงุฑูุงููโูุง ุญุณุงุจ ุจู <code>lsaiso.exe</code> ููุชูู ูโุดูุฏ. <code>lsaiso.exe</code> ุจุง ุงุณุชูุงุฏู ุงุฒ ููุงูุฑ ูุฌุงุฒโุณุงุฒ ุณุฎุชโุงูุฒุงุฑุ ุฏุฑ ฺฉ ูุญุท ุงุฒููู ุงุฌุฑุง ูโุดูุฏ ฺฉู ุงุฒ ุณุงุฑ ูุฑุขูุฏูุง ุฌุฏุง ุงุณุช. ุฒูุงู ฺฉู ุงุญุฑุงุฒ ููุช ุงุฒ ุฑุงู ุฏูุฑ ููุฑุฏ ูุงุฒ ุงุณุชุ <code>lsass.exe</code> ุฏุฑุฎูุงุณุชโูุง ุฑุง ุงุฒ ุทุฑู ฺฉ ฺฉุงูุงู RPC ุจู <code>lsaiso.exe</code> ุงุฑุณุงู ูโฺฉูุฏ ุชุง ฺฉุงุฑุจุฑ ุฑุง ุจู ุณุฑูุณ ุฑุงู ุฏูุฑ ุงุญุฑุงุฒ ููุช ฺฉูุฏ. ุงฺฏุฑ VBS ูุนุงู ูุจุงุดุฏุ <code>lsaiso.exe</code> ูุจุงุฏ ุฏุฑ ุณุณุชู ุงุฌุฑุง ุดูุฏ.</p>

<p>ุงุฒ ูุธุฑ ุงููุชุ <code>lsass.exe</code> ฺฉ ูุฏู ุงุตู ุจุฑุง ุญููุงุช Credential Dumping ุงุณุช. ุงุจุฒุงุฑูุง ูุงููุฏ Mimikatzุ ProcDump ู Comsvcs.dll ุงุบูุจ ุจุฑุง ุงุณุชุฎุฑุงุฌ ุงุนุชุจุงุฑูุงููโูุง ุงุฒ ุญุงูุธู ุงู ูุฑุขูุฏ ุงุณุชูุงุฏู ูโุดููุฏ. ุนูุงุฆู ูุดุฏุงุฑุฏููุฏู ุดุงูู ูุฌูุฏ ุจุด ุงุฒ ฺฉ ููููู ุงุฒ <code>lsass.exe</code>ุ ูุงูุฏ ุบุฑ ุงุฒ <code>wininit.exe</code>ุ ุฏุงุดุชู ูุฑุขูุฏูุง ูุฑุฒูุฏ ุบุฑูุนูููุ ุง ุชูุงุด ูุฑุขูุฏูุง ุบุฑูุนููู ุจุฑุง ุจุงุฒ ฺฉุฑุฏู ฺฉ handle ุจู <code>lsass.exe</code> ุจุง ุฏุณุชุฑุณ PROCESS_VM_READ ูุณุชูุฏ. ุชุญููฺฏุฑุงู ุจุงุฏ ุจู ุฏูุช Event ID 10 ุฏุฑ Sysmon (ProcessAccess) ุฑุง ุจุฑุง ุดูุงุณุง ฺูู ุชูุงุดโูุง ูุธุงุฑุช ฺฉููุฏ.</p>

<h3>Windows Logon Process (winlogon.exe)</h3>

<p>ูุฑุขูุฏ <b>winlogon.exe</b> ูุณุฆูู ูุฏุฑุช ุชูุงู ุฌูุจูโูุง ูุฑูุฏ ู ุฎุฑูุฌ ุชุนุงูู ฺฉุงุฑุจุฑุงู ุงุณุช. ุฒูุงู ฺฉู ูุฑูุฏ ููููุชโุขูุฒ ุงุณุช ู ุชูุณุท ูุฑุขูุฏ LSASS ุชุฃุฏ ูโุดูุฏุ <code>winlogon.exe</code> ูุฑุขูุฏูุง ููุฑุณุช ุดุฏู ุฏุฑ ููุฏุงุฑ ุฑุฌุณุชุฑ "Userinit" ฺฉู ุฏุฑ <code>HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon</code> ูุฑุงุฑ ุฏุงุฑุฏ ุฑุง ุฑุงูโุงูุฏุงุฒ ูโฺฉูุฏ. ุจู ุทูุฑ ูพุดโูุฑุถุ ุงู ููุฏุงุฑ ุจู <code>userinit.exe</code> ุงุดุงุฑู ุฏุงุฑุฏ.</p>

<p>ูุณุฑ ุงุฌุฑุง ุงู ูุฑุขูุฏ <code>%SystemRoot%\System32\winlogon.exe</code> ุงุณุชุ ูุงูุฏ ุขู ฺฉ ููููู ูุฑุฒูุฏ ุงุฒ <code>smss.exe</code> ุจุง ุดูุงุฑู ูุดุณุช ุจุดุชุฑ ุงุฒ ุตูุฑ ุงุณุช ฺฉู ูพุณ ุงุฒ ุงุฌุงุฏ <code>winlogon.exe</code> ุฎุงุชูู ุงูุชู ู ุจูุงุจุฑุงู <code>winlogon.exe</code> ุจู ุนููุงู ฺฉ ูุฑุขูุฏ ุชู ุธุงูุฑ ูโุดูุฏ. ุงู ูุฑุขูุฏ ุชุญุช ุญุณุงุจ ฺฉุงุฑุจุฑ Local System ุงุฌุฑุง ูโุดูุฏ ู ฺฉ ููููู ุจุฑุง ูุฑ ูุดุณุช ฺฉุงุฑุจุฑ ูุฌูุฏ ุฏุงุฑุฏ. ูุฑุขูุฏูุง ูุฑุฒูุฏ ูุนููู ุงู ูุฑุขูุฏ ุนุจุงุฑุชูุฏ ุงุฒ <code>LogonUI.exe</code>ุ <code>userinit.exe</code>ุ <code>dwm.exe</code> ู <code>fontdrvhost.exe</code>.</p>

<p>ฺฉ ุงุฒ ูฺฉุงุช ููู ฺฉู ุฏุฑ ูพูุณุชุฑ ุงุตู ุจู ุขู ุงุดุงุฑู ูุดุฏู ุจูุฏุ ุงู ุงุณุช ฺฉู <code>winlogon.exe</code> ฺฉ ููุทู ุจุญุฑุงู ุจุฑุง ูพุงุฏุงุฑ (Persistence) ุจุฏุงูุฒุงุฑูุง ุงุณุช. ููุงุฌูุงู ุงุบูุจ ฺฉูุฏูุง ุฑุฌุณุชุฑ ูุฑุชุจุท ุจุง <code>winlogon.exe</code> ูุงููุฏ <code>Userinit</code>ุ <code>Shell</code>ุ <code>Notify</code> ู <code>UserInitMprLogonScript</code> ุฑุง ุชุบุฑ ูโุฏููุฏ ุชุง ุจุฏุงูุฒุงุฑ ุฎูุฏ ุฑุง ุฏุฑ ูุฑ ุจุงุฑ ูุฑูุฏ ฺฉุงุฑุจุฑ ุงุฌุฑุง ฺฉููุฏ. ุนูุงูู ุจุฑ ุงูุ ููุงุฌูุงู ููฺฉู ุงุณุช ุงุฒ Winlogon Helper DLLs ฺฉู ุฏุฑ <code>HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Notify</code> ุชุนุฑู ุดุฏูโุงูุฏุ ุจุฑุง ุงุฌุฑุง ฺฉุฏ ูุฎุฑุจ ุฏุฑ ุฑูุฏุงุฏูุง ูุฎุชูู ูุฑูุฏ ุงุณุชูุงุฏู ฺฉููุฏ.</p>

<p>ุงุฒ ูุธุฑ ุงููุชุ ูุงูุฏ ุบุฑ ุงุฒ <code>smss.exe</code> (ุชู)ุ ุงุฌุฑุง ุชุญุช ุญุณุงุจ ฺฉุงุฑุจุฑ ุบุฑ ุงุฒ Local Systemุ ุง ุนุฏู ูุฌูุฏ ุจู ุนููุงู ูุงูุฏ <code>userinit.exe</code> ุฏุฑ ุฒูุงู ูุฑูุฏุ ููฺฏ ุนูุงุฆู ูุดุฏุงุฑุฏููุฏู ูุณุชูุฏ. ุชุญููฺฏุฑุงู ููฺูู ุจุงุฏ ฺฉูุฏูุง ุฑุฌุณุชุฑ ูุฑุชุจุท ุจุง <code>winlogon.exe</code> ุฑุง ุจู ุฏูุช ุจุฑุฑุณ ฺฉููุฏ ุชุง ุงุฒ ุนุฏู ูุฌูุฏ ูฺฉุงูุฒูโูุง ูพุงุฏุงุฑ ูุฎุฑุจ ุงุทููุงู ุญุงุตู ฺฉููุฏ.</p>

<h3>Windows Explorer (explorer.exe)</h3>

<p>ูุฑุขูุฏ <b>explorer.exe</b> ูพูุณุชู ูพุดโูุฑุถ (Default Shell) ููุฏูุฒ ุงุณุช ฺฉู ุฑุงุจุท ฺฉุงุฑุจุฑ ฺฏุฑุงูฺฉ ุงุตู ุฑุง ูุฑุงูู ูโฺฉูุฏ. ุงู ูุฑุขูุฏ ุฏุฑ ูุณุชู ุฎูุฏุ ุจู ฺฉุงุฑุจุฑุงู ุฏุณุชุฑุณ ุจู ูุงูโูุง ุฑุง ูุฑุงูู ูโฺฉูุฏุ ุงูุง ุงุฒ ูุธุฑ ุนููฺฉุฑุฏุ ูู ฺฉ ูุฑูุฑฺฏุฑ ูุงู ุงุฒ ุทุฑู Windows Explorer ุงุณุช ู ูู ฺฉ ุฑุงุจุท ฺฉุงุฑุจุฑ ฺฉู ูฺฺฏโูุง ูุงููุฏ ุฏุณฺฉุชุงูพ ฺฉุงุฑุจุฑุ ููู ุงุณุชุงุฑุชุ ููุงุฑ ูุธููุ ฺฉูุชุฑู ูพูู ู ุฑุงูโุงูุฏุงุฒ ุจุฑูุงููโูุง ุงุฒ ุทุฑู ูพุณููุฏูุง ูุงู ู ูุงูโูุง ูุงูุจุฑ ุฑุง ูุฑุงูู ูโฺฉูุฏ.</p>

<p>ูุณุฑ ุงุฌุฑุง ุงู ูุฑุขูุฏ <code>%SystemRoot%\explorer.exe</code> ุงุณุช (ุชูุฌู ฺฉูุฏ ฺฉู ุฏุฑ ุฑุดู SystemRoot ุงุณุชุ ูู ุฏุฑ System32)ุ ูุงูุฏ ุขู ูุฑุขูุฏ <code>userinit.exe</code> ุงุณุช ฺฉู ูพุณ ุงุฒ ุฑุงูโุงูุฏุงุฒ <code>explorer.exe</code> ุฎุงุชูู ูโุงุจุฏ ู ุจูุงุจุฑุงู <code>explorer.exe</code> ุจู ุนููุงู ฺฉ ูุฑุขูุฏ ุชู ุธุงูุฑ ูโุดูุฏ. ุงู ูุฑุขูุฏ ุชุญุช ุญุณุงุจ ฺฉุงุฑุจุฑ ฺฉุงุฑุจุฑ ูุงุฑุฏ ุดุฏู ุงุฌุฑุง ูโุดูุฏ ู ฺฉ ููููู ุจุฑุง ูุฑ ฺฉุงุฑุจุฑ ูุชุตู ุจู ุณุณุชู ูุฌูุฏ ุฏุงุฑุฏ. ุงู ูุฑุขูุฏ ูุงูุฏ ุจุณุงุฑ ุงุฒ ูุฑุขูุฏูุง ุงุณุชุ ุฒุฑุง ุงฺฉุซุฑ ุจุฑูุงููโูุง ฺฉู ฺฉุงุฑุจุฑุงู ุจู ุตูุฑุช ุชุนุงูู ุงุฌุฑุง ูโฺฉููุฏ (ูุงููุฏ ฺฉูฺฉ ุฑู ฺฉ ูุงู ุง ฺฉ ูุงูุจุฑ) ุชูุณุท <code>explorer.exe</code> ุฑุงูโุงูุฏุงุฒ ูโุดููุฏ.</p>

<p>ฺฉ ุงุฒ ูฺฉุงุช ููู ฺฉู ุฏุฑ ูพูุณุชุฑ ุงุตู ุจู ุขู ุงุดุงุฑู ูุดุฏู ุจูุฏุ ุงู ุงุณุช ฺฉู ูพูุณุชู ูพุดโูุฑุถ ุฏุฑ ููุฏุงุฑ ุฑุฌุณุชุฑ <code>HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Shell</code> ูุดุฎุต ุดุฏู ุงุณุช ู ุจู ุทูุฑ ูพุดโูุฑุถ ุจู <code>explorer.exe</code> ุงุดุงุฑู ุฏุงุฑุฏ. ุจุง ุงู ุญุงูุ ููุฏูุฒ ูโุชูุงูุฏ ุจุง ุฑุงุจุทโูุง ุฏฺฏุฑ ูุงููุฏ <code>cmd.exe</code> ุง <code>powershell.exe</code> ูุฒ ฺฉุงุฑ ฺฉูุฏ. ููุงุฌูุงู ููฺฉู ุงุณุช ุงู ููุฏุงุฑ ุฑุฌุณุชุฑ ุฑุง ุชุบุฑ ุฏููุฏ ุชุง ฺฉ ูพูุณุชู ูุฎุฑุจ ุฑุง ุจู ุฌุง <code>explorer.exe</code> ุงุฌุฑุง ฺฉููุฏ. ููฺููุ ฺฏุฒูู "Launch folder windows in a separate process" ุฏุฑ ููุฏูุฒ ูโุชูุงูุฏ ููุฌุฑ ุจู ูุฌูุฏ ฺูุฏู ููููู ุงุฒ <code>explorer.exe</code> ุจุฑุง ูุฑ ฺฉุงุฑุจุฑ ุดูุฏ.</p>

<p>ุงุฒ ูุธุฑ ุงููุชุ ูุงูุฏ ุบุฑ ุงุฒ <code>userinit.exe</code> (ุชู)ุ ูุณุฑ ุงุฌุฑุง ุฏุฑ <code>System32</code> (ุจุงุฏ ุฏุฑ ุฑุดู SystemRoot ุจุงุดุฏ)ุ ุง ุงุฌุฑุง ุชุญุช ุญุณุงุจ Local Systemุ ููฺฏ ุนูุงุฆู ูุดุฏุงุฑุฏููุฏู ูุณุชูุฏ. ููฺููุ ุงฺฏุฑ <code>explorer.exe</code> ูุฑุขูุฏูุง ูุฑุฒูุฏ ุบุฑูุนููู ูุงููุฏ <code>cmd.exe</code>ุ <code>powershell.exe</code> ุง ุงุจุฒุงุฑูุง ุณุณุชู ุฑุง ุจุฏูู ุชุนุงูู ฺฉุงุฑุจุฑ ุงุฌุฑุง ฺฉูุฏุ ุงู ููุงุฑุฏ ุจุงุฏ ููุฑุฏ ุจุฑุฑุณ ุฏูู ูุฑุงุฑ ฺฏุฑูุฏ ุฒุฑุง ููฺฉู ุงุณุช ูุดุงููโุง ุงุฒ ฺฉ ูููุฐ ุจุงุดูุฏ.</p>

</div>
