<div dir="rtl" align="right">

# ุดูุงุฎุช ุฑูุชุงุฑ ูุฑูุงู: ุฑุงูููุง ุฌุงูุน ุชุญูู ูุฑุขูุฏูุง ุญุงุช ููุฏูุฒ ุจุฑุง ุดฺฉุงุฑ ุชูุฏุฏุงุช

## ๐ ููุฑุณุช ูุทุงูุจ
1. [ููุฏูู](#ููุฏูู)
2. [ุงููุช ุดูุงุฎุช ุฑูุชุงุฑ ูุฑูุงู](#ุงููุช-ุดูุงุฎุช-ุฑูุชุงุฑ-ูุฑูุงู)
3. [ูุฑุขูุฏูุง ุญุงุช ููุฏูุฒ](#ูุฑุขูุฏูุง-ุญุงุช-ููุฏูุฒ)
4. [ููุงูู ุดูุงุณุง ู ฺฺฉโูุณุช ุนููุงุช](#ููุงูู-ุดูุงุณุง-ู-ฺฺฉโูุณุช-ุนููุงุช)
5. [ุงุจุฒุงุฑูุง ุชุญูู ู ูุธุงุฑุช](#ุงุจุฒุงุฑูุง-ุชุญูู-ู-ูุธุงุฑุช)
6. [ุณูุงุฑููุง ูุงูุน](#ุณูุงุฑููุง-ูุงูุน)
7. [ููุงุจุน ู ูุฑุงุฌุน](#ููุงุจุน-ู-ูุฑุงุฌุน)

---

## ููุฏูู

ุฏุฑ ุฏูุง ุงูุฑูุฒ ุงููุช ุณุงุจุฑุ ุดูุงุณุง ุจูโูููุน ุชูุฏุฏุงุช ูพุดุฑูุชู (<bdi>Advanced Persistent Threats - APT</bdi>) ู ุญููุงุช ุจุงุฌโุงูุฒุงุฑ (<bdi>Ransomware</bdi>) ุจู ฺฉ ุงุฒ ฺุงูุดโูุง ุงุตู ุชูโูุง <bdi>SOC</bdi> ู <bdi>Incident Response</bdi> ุชุจุฏู ุดุฏู ุงุณุช. ููุงุฌูุงู ูุฏุฑู ุงุฒ ุชฺฉูฺฉโูุง ูพฺุฏูโุง ูุงููุฏ <bdi>Living off the Land (LotL)</bdi>ุ <bdi>Process Injection</bdi> ู <bdi>Masquerading</bdi> ุงุณุชูุงุฏู ูโฺฉููุฏ ุชุง ูุนุงูุชโูุง ูุฎุฑุจ ุฎูุฏ ุฑุง ุฏุฑ ูพูุดุด ูุฑุขูุฏูุง ูุดุฑูุน ุณุณุชู ูพููุงู ฺฉููุฏ.

**ูพุงู ุงุตู ุดฺฉุงุฑ ุชูุฏุฏุงุช** (<bdi>Threat Hunting</bdi>) ู ุชุญูู ุฑูุชุงุฑ (<bdi>Behavioral Analysis</bdi>)ุ ุดูุงุฎุช ุฏูู ู ุนูู ุงุฒ **ุฑูุชุงุฑ ูุฑูุงู** ุณุณุชูโุนุงูู ุงุณุช. ุจุฏูู ุงู ุดูุงุฎุชุ ุชุดุฎุต ูุงููุฌุงุฑโูุง ุชูุฑุจุงู ุบุฑููฺฉู ุฎูุงูุฏ ุจูุฏ.

ุงู ููุงูู ุจู ุจุฑุฑุณ ุฌุงูุน ูุฑุขูุฏูุง ุญุงุช ููุฏูุฒุ ุฑูุงุจุท ูุงูุฏ-ูุฑุฒูุฏ ุขูโูุงุ ุญุณุงุจโูุง ฺฉุงุฑุจุฑ ูุฌุงุฒุ ุขุฑฺฏููุงูโูุง ุฎุท ูุฑูุงู ู ูุดุงููโูุง ุงููุช ูุดฺฉูฺฉ ูโูพุฑุฏุงุฒุฏ. ููฺูู ุฑุงูฺฉุงุฑูุง ุนูู ุจุฑุง ุดูุงุณุง ุฎูุฏฺฉุงุฑ ู ูพุงุณุฎ ุจู ุชูุฏุฏุงุช ุงุฑุงุฆู ูโุดูุฏ.

### ุงูุฏุงู ุงู ุฑุงูููุง:
- **ุขููุฒุด ุนูู** ูฺฺฏโูุง ูุฑุขูุฏูุง ุญุงุช ููุฏูุฒ
- **ุงุฑุงุฆู ุฑุงูฺฉุงุฑูุง ุนูู** ุจุฑุง ุดูุงุณุง ุฎูุฏฺฉุงุฑ ุชูุฏุฏุงุช
- **ุชููุช ููุงุฑุชโูุง Threat Hunting** ุจุง ุฏุงูุด ูุณุชูุฏ ู ฺฉุงุฑุจุฑุฏ
- **ฺฉุงูุด ุฒูุงู ุดูุงุณุง** (<bdi>Mean Time to Detect - MTTD</bdi>) ุฏุฑ ุญูุงุฏุซ ุงููุช

---

## ุงููุช ุดูุงุฎุช ุฑูุชุงุฑ ูุฑูุงู

### ฺุฑุง ุฑูุชุงุฑ ูุฑูุงู ุงููุช ุฏุงุฑุฏุ

ูุทุงุจู ฺุงุฑฺูุจ <bdi>MITRE ATT&CK</bdi>ุ ููุงุฌูุงู ุงุฒ ุชฺฉูฺฉโูุง ูุชุนุฏุฏ ุจุฑุง ูพููุงูโุณุงุฒ ุงุณุชูุงุฏู ูโฺฉููุฏ:

| ุชฺฉูฺฉ ููุงุฌู | ุดูุงุณู MITRE | ุชูุถุญ |
|-------------|-------------|--------|
| <bdi>Process Injection</bdi> | T1055 | ุชุฒุฑู ฺฉุฏ ุจู ูุฑุขูุฏูุง ูุดุฑูุน |
| <bdi>Masquerading</bdi> | T1036 | ุฌุนู ููุช ุจุง ูุงูโูุง ูุดุงุจู ูุฑุขูุฏูุง |
| <bdi>Process Hollowing</bdi> | T1055.012 | ุฎุงู ฺฉุฑุฏู ุญุงูุธู ูุฑุขูุฏ ู ุฌุงฺฏุฒู ฺฉุฏ ูุฎุฑุจ |
| <bdi>DLL Injection</bdi> | T1055.001 | ุชุฒุฑู ฺฉุชุงุจุฎุงููโูุง ูุฎุฑุจ |
| <bdi>Credential Dumping</bdi> | T1003.001 | ุงุณุชุฎุฑุงุฌ ุงุนุชุจุงุฑูุงููโูุง ุงุฒ ุญุงูุธู <bdi>LSASS</bdi> |

**ุจุฏูู ุดูุงุฎุช ุฑูุชุงุฑ ูุฑูุงู:**
- ูุฑุขูุฏ `svchost.exe` ุจุฏูู ูพุงุฑุงูุชุฑ <bdi>`-k`</bdi> ูุงุจู ุชุดุฎุต ูุณุช
- ูุฑุขูุฏ `lsass.exe` ุจุง ูุงูุฏ ุบุฑูุนููู ุดูุงุณุง ููโุดูุฏ
- <bdi>Process Masquerading</bdi> ุจุง ูุงูโูุง ูุงููุฏ `csrsss.exe` (ุจุง ุณู ุญุฑู s) ุงุฒ ุฏุฏ ุชุญููฺฏุฑุงู ูพููุงู ูโูุงูุฏ

---

## ูุฑุขูุฏูุง ุญุงุช ููุฏูุฒ

### 1. ูุฑุขูุฏ System ู Memory Compression

#### System (ntoskrnl.exe)

<table dir="rtl">
<tr>
<th>ูฺฺฏ</th>
<th>ููุฏุงุฑ ูุฑูุงู</th>
</tr>
<tr>
<td><b>ูุงู ูุฑุขูุฏ</b></td>
<td><code>System</code></td>
</tr>
<tr>
<td><b>ุดูุงุณู ูุฑุขูุฏ (PID)</b></td>
<td>4 (ููุดู ุซุงุจุช)</td>
</tr>
<tr>
<td><b>ูุณุฑ ุงุฌุฑุง</b></td>
<td><code>ntoskrnl.exe</code> ุฏุฑ <bdi>Task Manager</bdi> / <code>None</code> ุฏุฑ <bdi>Process Explorer</bdi></td>
</tr>
<tr>
<td><b>ูุงูุฏ</b></td>
<td>ูฺ (ุงู ูุฑุขูุฏ ุฑุดู ุงุณุช)</td>
</tr>
<tr>
<td><b>ูุฑุฒูุฏุงู</b></td>
<td>ููุท <code>smss.exe</code> ู <code>Memory Compression</code></td>
</tr>
<tr>
<td><b>ุญุณุงุจ ฺฉุงุฑุจุฑ</b></td>
<td><bdi>NT AUTHORITY\SYSTEM</bdi></td>
</tr>
<tr>
<td><b>Session ID</b></td>
<td>0</td>
</tr>
</table>

**ุชูุถุญุงุช ุชฺฉูู:**

ูุฑุขูุฏ <bdi>System</bdi> ุฏุฑ ูุงูุน ฺฉ ูุฑุขูุฏ ูุงูุน ุฏุฑ ูุถุง ฺฉุงุฑุจุฑ (<bdi>User Space</bdi>) ูุณุชุ ุจูฺฉู ููุงุด ุงุฒ ูุนุงูุชโูุง ูุณุชู ุณุณุชูโุนุงูู (<bdi>Kernel Mode Threads</bdi>) ุงุณุช. ุงู ูุฑุขูุฏ ูุฒุจุงู ุชูุงู ุชุฑุฏโูุง ุญุงูุช ูุณุชู ุจูุฏู ู ููุด ุจุณุงุฑ ุญุงุช ุฏุฑ ุนููฺฉุฑุฏ ุณุณุชู ุฏุงุฑุฏ.

**ฺฉ ุงุฒ ูฺฺฏโูุง ููุญุตุฑุจูโูุฑุฏ:** <bdi>PID</bdi> ุงู ูุฑุขูุฏ ููุดู 4 ุงุณุช ู ุฏุฑ ุชูุงู ูุณุฎูโูุง ููุฏูุฒ ุงุฒ <bdi>Windows NT</bdi> ุชุง <bdi>Windows 11</bdi> ุชุบุฑ ูฺฉุฑุฏู ุงุณุช.

#### Memory Compression

<table dir="rtl">
<tr>
<th>ูฺฺฏ</th>
<th>ููุฏุงุฑ ูุฑูุงู</th>
</tr>
<tr>
<td><b>ูุงู ูุฑุขูุฏ</b></td>
<td><code>Memory Compression</code></td>
</tr>
<tr>
<td><b>ูุณุฑ ุงุฌุฑุง</b></td>
<td><code>%SystemRoot%\System32\ntoskrnl.exe</code></td>
</tr>
<tr>
<td><b>ูุงูุฏ</b></td>
<td><code>System (PID 4)</code></td>
</tr>
<tr>
<td><b>ูุฑุฒูุฏุงู</b></td>
<td>ูฺ</td>
</tr>
<tr>
<td><b>ุญุณุงุจ ฺฉุงุฑุจุฑ</b></td>
<td><bdi>NT AUTHORITY\SYSTEM</bdi></td>
</tr>
<tr>
<td><b>ุชุนุฏุงุฏ ููููู</b></td>
<td>ููุท ฺฉ ููููู</td>
</tr>
<tr>
<td><b>ูุณุฎู ููุฏูุฒ</b></td>
<td><bdi>Windows 10+</bdi></td>
</tr>
</table>

**ุชูุถุญุงุช ุชฺฉูู:**

ุงู ูุฑุขูุฏ ุงุฒ <bdi>Windows 10</bdi> ุจู ุจุนุฏ ุงุถุงูู ุดุฏู ู ูุธูู ูุดุฑุฏูโุณุงุฒ ุญุงูุธู ูุฑุขูุฏูุง ุฏุฑ <bdi>RAM</bdi> ุฑุง ุจุฑ ุนูุฏู ุฏุงุฑุฏ. ุจู ุฌุง <bdi>Paging</bdi> ุฏุงุฏูโูุง ุจู ุฏุณฺฉ (ฺฉู ฺฉูุฏ ุงุณุช)ุ ููุฏูุฒ ุงุจุชุฏุง ุญุงูุธู ุฑุง ูุดุฑุฏู ูโฺฉูุฏ ุชุง ุนููฺฉุฑุฏ ุณุณุชู ุจูุจูุฏ ุงุจุฏ.

**๐จ ุนูุงุฆู ูุดุฏุงุฑ ุงููุช:**

| ูุดุงูู ูุดฺฉูฺฉ | ุงุญุชูุงู ุชูุฏุฏ | ุงูุฏุงู ุชูุตูโุดุฏู |
|-------------|--------------|-----------------|
| ูุฌูุฏ ูุฑุฒูุฏ ุบุฑ ุงุฒ `smss.exe` ู `Memory Compression` | ุจุณุงุฑ ุจุงูุง | ุจุฑุฑุณ ููุฑ ุจุง <bdi>Process Explorer</bdi> ู ุชุญูู <bdi>Memory Dump</bdi> |
| ุชุบุฑ <bdi>PID</bdi> ุงุฒ 4 ุจู ุนุฏุฏ ุฏฺฏุฑ | ุจุณุงุฑ ุจุงูุง | ุงุญุชูุงู <bdi>Rootkit</bdi> - ูุงุฒ ุจู ุชุญูู ุนูู |
| ูุตุฑู <bdi>CPU</bdi> ุง <bdi>Network</bdi> ุบุฑุนุงุฏ | ูุชูุณุท ุชุง ุจุงูุง | ุจุฑุฑุณ <bdi>Driver</bdi>ูุง ุจุงุฑฺฏุฐุงุฑโุดุฏู ุจุง `driverquery` |

---

### 2. Session Manager Subsystem (smss.exe)

<table dir="rtl">
<tr>
<th>ูฺฺฏ</th>
<th>ููุฏุงุฑ ูุฑูุงู</th>
</tr>
<tr>
<td><b>ูุงู ูุฑุขูุฏ</b></td>
<td><code>smss.exe</code></td>
</tr>
<tr>
<td><b>ูุณุฑ ุงุฌุฑุง</b></td>
<td><code>%SystemRoot%\System32\smss.exe</code></td>
</tr>
<tr>
<td><b>ูุงูุฏ</b></td>
<td><code>System (PID 4)</code></td>
</tr>
<tr>
<td><b>ูุฑุฒูุฏุงู</b></td>
<td>โข ูููููโูุง ูุฑุฒูุฏ <code>smss.exe</code> (ูููุช)<br>โข <code>csrss.exe</code> (Session 0 ู 1)<br>โข <code>wininit.exe</code> (Session 0)<br>โข <code>winlogon.exe</code> (Session 1)</td>
</tr>
<tr>
<td><b>ุญุณุงุจ ฺฉุงุฑุจุฑ</b></td>
<td><bdi>NT AUTHORITY\SYSTEM</bdi></td>
</tr>
<tr>
<td><b>ุขุฑฺฏููุงู ุฎุท ูุฑูุงู</b></td>
<td>ููููู ุงุตู: ุจุฏูู ุขุฑฺฏููุงู<br>ูููููโูุง ูุฑุฒูุฏ: ุฏุงุฑุง ุขุฑฺฏููุงู</td>
</tr>
<tr>
<td><b>ุชุนุฏุงุฏ ููููู ูพุงุฏุงุฑ</b></td>
<td>ููุท ฺฉ ููููู ุงุตู</td>
</tr>
</table>

**ุชูุถุญุงุช ุชฺฉูู:**

<bdi>smss.exe</bdi> ุงููู ูุฑุขูุฏ ุญุงูุช ฺฉุงุฑุจุฑ (<bdi>User Mode</bdi>) ุฏุฑ ููุฏูุฒ ุงุณุช ู ููุด ฺฉูุฏ ุฏุฑ ุฑุงูโุงูุฏุงุฒ ุณุณุชู ุฏุงุฑุฏ. ุงู ูุฑุขูุฏ ูุณุฆููุชโูุง ูุชุนุฏุฏ ุฏุงุฑุฏ:

- **ุงุฌุงุฏ ูุชุบุฑูุง ูุญุท** (<bdi>Environment Variables</bdi>) ุณุณุชู
- **ููุฏุงุฑุฏู ุงููู ุฑุฌุณุชุฑ** (ูุงููุง <bdi>HKLM\Software</bdi>ุ <bdi>SAM</bdi>ุ <bdi>Security</bdi>)
- **ุงุฌุงุฏ ุชูุตูฺฏุฑูุง ุงููุช** (<bdi>Security Descriptors</bdi>)
- **ุฑุงูโุงูุฏุงุฒ ุฒุฑุณุณุชูโูุง ููุฏูุฒ**

**ูุนูุงุฑ ุงุฌุฑุง:**

```
System (PID 4)
    โโโ smss.exe (Master Instance - ุจุฏูู ุขุฑฺฏููุงู)
        โโโ smss.exe (Session 0 - ูููุช)
        โ   โโโ csrss.exe (Session 0)
        โ   โโโ wininit.exe (Session 0)
        โโโ smss.exe (Session 1 - ูููุช)
            โโโ csrss.exe (Session 1)
            โโโ winlogon.exe (Session 1)
```

ูพุณ ุงุฒ ุงุฌุงุฏ ูุฑุขูุฏูุง <bdi>csrss.exe</bdi>ุ <bdi>wininit.exe</bdi> ู <bdi>winlogon.exe</bdi>ุ ูููููโูุง ูุฑุฒูุฏ <bdi>smss.exe</bdi> ุฎุงุชูู ูโุงุจูุฏ ู ุชููุง ููููู ุงุตู ุจุงู ูโูุงูุฏ.

**๐จ ุนูุงุฆู ูุดุฏุงุฑ ุงููุช:**

| ูุดุงูู ูุดฺฉูฺฉ | ุงุญุชูุงู ุชูุฏุฏ | ุชฺฉูฺฉ MITRE | ุงูุฏุงู ุชูุตูโุดุฏู |
|-------------|--------------|-------------|-----------------|
| ุจุด ุงุฒ ฺฉ ููููู ูพุงุฏุงุฑ ุจุฏูู ุขุฑฺฏููุงู | ุจุณุงุฑ ุจุงูุง | T1036.004 | ุจุฑุฑุณ <bdi>Hash</bdi> ูุงู ุจุง <bdi>VirusTotal</bdi> |
| ูุงูุฏ ุบุฑ ุงุฒ `System` | ุจุณุงุฑ ุจุงูุง | T1055 | ุงุญุชูุงู <bdi>Process Injection</bdi> |
| ูุณุฑ ุงุฌุฑุง ุฎุงุฑุฌ ุงุฒ `System32` | ุจุณุงุฑ ุจุงูุง | T1036.005 | ูุฑูุทูู ููุฑ ู ุชุญูู <bdi>Malware</bdi> |
| ูุงูโูุง ูุดุงุจู: `smsss.exe`, `smss32.exe` | ุจุณุงุฑ ุจุงูุง | T1036.004 | <bdi>Masquerading</bdi> - ุญุฐู ููุฑ |

**ูุซุงู Command Line ูุฑูุงู:**
```
C:\Windows\System32\smss.exe
```

**ูุซุงู Command Line ูุดฺฉูฺฉ:**
```
C:\Windows\System32\smss.exe \SystemRoot\System32\csrss.exe ObjectDirectory=\Windows SharedSection=1024,20480,768
```
*(ููููู ูุฑุฒูุฏ ฺฉู ูุจุงุฏ ูพุงุฏุงุฑ ุจูุงูุฏ)*

---

### 3. Client/Server Runtime Subsystem (csrss.exe)

<table dir="rtl">
<tr>
<th>ูฺฺฏ</th>
<th>ููุฏุงุฑ ูุฑูุงู</th>
</tr>
<tr>
<td><b>ูุงู ูุฑุขูุฏ</b></td>
<td><code>csrss.exe</code></td>
</tr>
<tr>
<td><b>ูุณุฑ ุงุฌุฑุง</b></td>
<td><code>%SystemRoot%\System32\csrss.exe</code></td>
</tr>
<tr>
<td><b>ูุงูุฏ</b></td>
<td>ุชู (<bdi>Orphan</bdi>) - ูุงูุฏ ุงุตู: ููููู ูุฑุฒูุฏ <code>smss.exe</code></td>
</tr>
<tr>
<td><b>ูุฑุฒูุฏุงู</b></td>
<td><b>ูฺ</b> (ูุฑฺฏุฒ ูุจุงุฏ ูุฑุฒูุฏ ุฏุงุดุชู ุจุงุดุฏ)</td>
</tr>
<tr>
<td><b>ุญุณุงุจ ฺฉุงุฑุจุฑ</b></td>
<td><bdi>NT AUTHORITY\SYSTEM</bdi></td>
</tr>
<tr>
<td><b>ุชุนุฏุงุฏ ููููู</b></td>
<td>ุญุฏุงูู 2 (ฺฉ ุจุฑุง ูุฑ <bdi>Session</bdi>)</td>
</tr>
<tr>
<td><b>Session ID</b></td>
<td>โข Session 0: ุณุฑูุณโูุง ุณุณุชู<br>โข Session 1+: ฺฉุงุฑุจุฑุงู ุชุนุงูู</td>
</tr>
</table>

**ุชูุถุญุงุช ุชฺฉูู:**

<bdi>csrss.exe</bdi> ุฒุฑุณุณุชู <bdi>Windows</bdi> ุฑุง ุฏุฑ ุญุงูุช ฺฉุงุฑุจุฑ ูพุงุฏูโุณุงุฒ ูโฺฉูุฏ ู ูุธุงู ุญุงุช ูุชุนุฏุฏ ุฏุงุฑุฏ:

- **ูุฏุฑุช ูุฑุขูุฏูุง ู ุชุฑุฏโูุง**
- **ูุงุฑุฏ ฺฉุฑุฏู DLLูุง Windows API**
- **ูุฏุฑุช ุฎุงููุด ุดุฏู GUI**
- **ูุฏุฑุช ฺฉูุณูู (Console Windowing)**

**ฺุฑุง csrss.exe ุชู ุงุณุชุ**

ูุงูุฏ ุงุตู <bdi>csrss.exe</bdi> ฺฉ ููููู ูุฑุฒูุฏ ุงุฒ <bdi>smss.exe</bdi> ุงุณุช ฺฉู ูพุณ ุงุฒ ุงุฌุงุฏ <bdi>csrss.exe</bdi> ุฎุงุชูู ูโุงุจุฏ. ุจูุงุจุฑุงู ุฏุฑ ุงุจุฒุงุฑูุง ูุงููุฏ <bdi>Process Explorer</bdi>ุ <bdi>csrss.exe</bdi> ุจุฏูู ูุงูุฏ (<bdi>Non-existent Parent PID</bdi>) ููุงุด ุฏุงุฏู ูโุดูุฏ.

**ุชุนุฏุงุฏ ูููููโูุง:**

| ุณูุงุฑู | ุชุนุฏุงุฏ ููููู csrss.exe |
|--------|----------------------|
| ุณุณุชู ูุนููู (ฺฉ ฺฉุงุฑุจุฑ) | 2 (Session 0 + Session 1) |
| ุงุณุชูุงุฏู ุงุฒ <bdi>Remote Desktop (RDP)</bdi> | 2 + ุชุนุฏุงุฏ ฺฉุงุฑุจุฑุงู RDP |
| ุงุณุชูุงุฏู ุงุฒ <bdi>Fast User Switching</bdi> | 2 + ุชุนุฏุงุฏ ฺฉุงุฑุจุฑุงู ููุฒูุงู |

**๐จ ุนูุงุฆู ูุดุฏุงุฑ ุงููุช:**

| ูุดุงูู ูุดฺฉูฺฉ | ุงุญุชูุงู ุชูุฏุฏ | ุชฺฉูฺฉ MITRE | ุงูุฏุงู ุชูุตูโุดุฏู |
|-------------|--------------|-------------|-----------------|
| ูุฌูุฏ ูุฑุขูุฏ ูุฑุฒูุฏ | ุจุณุงุฑ ุจุงูุง | T1055.012 | ุงุญุชูุงู <bdi>Process Hollowing</bdi> |
| ูุงูุฏ ูุนุงู (ุบุฑ ุชู) | ุจุณุงุฑ ุจุงูุง | T1055 | ุจุฑุฑุณ ููุฑ ูุงูุฏ |
| ูุณุฑ ุงุฌุฑุง ุฎุงุฑุฌ ุงุฒ `System32` | ุจุณุงุฑ ุจุงูุง | T1036.005 | ูุฑูุทูู ููุฑ |
| ูุงูโูุง ูุดุงุจู: `csrsss.exe`, `cssrss.exe` | ุจุณุงุฑ ุจุงูุง | T1036.004 | <bdi>Masquerading</bdi> |
| ุงุฌุฑุง ุจุง ุญุณุงุจ ุบุฑ ุงุฒ <bdi>SYSTEM</bdi> | ุจุณุงุฑ ุจุงูุง | T1134 | ุงุญุชูุงู <bdi>Token Manipulation</bdi> |

**ูุซุงู Command Line ูุฑูุงู:**
```
%SystemRoot%\system32\csrss.exe ObjectDirectory=\Windows SharedSection=1024,20480,768 Windows=On SubSystemType=Windows ServerDll=basesrv,1 ServerDll=winsrv:UserServerDllInitialization,3 ServerDll=sxssrv,4 ProfileControl=Off MaxRequestThreads=16
```

---

### 4. Windows Initialization Process (wininit.exe)

<table dir="rtl">
<tr>
<th>ูฺฺฏ</th>
<th>ููุฏุงุฑ ูุฑูุงู</th>
</tr>
<tr>
<td><b>ูุงู ูุฑุขูุฏ</b></td>
<td><code>wininit.exe</code></td>
</tr>
<tr>
<td><b>ูุณุฑ ุงุฌุฑุง</b></td>
<td><code>%SystemRoot%\System32\wininit.exe</code></td>
</tr>
<tr>
<td><b>ูุงูุฏ</b></td>
<td>ุชู - ูุงูุฏ ุงุตู: ููููู ูุฑุฒูุฏ <code>smss.exe</code> (Session 0)</td>
</tr>
<tr>
<td><b>ูุฑุฒูุฏุงู</b></td>
<td>โข <code>services.exe</code><br>โข <code>lsass.exe</code><br>โข <code>fontdrvhost.exe</code></td>
</tr>
<tr>
<td><b>ุญุณุงุจ ฺฉุงุฑุจุฑ</b></td>
<td><bdi>NT AUTHORITY\SYSTEM</bdi></td>
</tr>
<tr>
<td><b>Session ID</b></td>
<td>0</td>
</tr>
<tr>
<td><b>ุชุนุฏุงุฏ ููููู</b></td>
<td>ููุท ฺฉ ููููู</td>
</tr>
</table>

**ุชูุถุญุงุช ุชฺฉูู:**

<bdi>wininit.exe</bdi> ูุณุฆูู ููุฏุงุฑุฏู ุงููู ู ุฑุงูโุงูุฏุงุฒ ุงุฌุฒุง ุญุงุช ุณุณุชู ุงุณุช:

- **ุชูุธู ูุชุบุฑูุง ูุญุท**: <bdi>USERPROFILE</bdi>, <bdi>ALLUSERPROFILE</bdi>, <bdi>PUBLIC</bdi>, <bdi>ProgramData</bdi>
- **ุฑุงูโุงูุฏุงุฒ LSASS**: ุงุฌุงุฏ ูุฑุขูุฏ `lsass.exe` ู ุชูุธู ฺฉูุฏ ุฑูุฒูฺฏุงุฑ <bdi>LSA</bdi>
- **ุฑุงูโุงูุฏุงุฒ Service Control Manager**: ุงุฌุงุฏ ูุฑุขูุฏ `services.exe`
- **ุงุฌุงุฏ ุฏุงุฑฺฉุชูุฑ ูููุช**: `%SystemRoot%\Temp`

**๐จ ุนูุงุฆู ูุดุฏุงุฑ ุงููุช:**

| ูุดุงูู ูุดฺฉูฺฉ | ุงุญุชูุงู ุชูุฏุฏ | ุงูุฏุงู ุชูุตูโุดุฏู |
|-------------|--------------|-----------------|
| ุจุด ุงุฒ ฺฉ ููููู | ุจุณุงุฑ ุจุงูุง | ุจุฑุฑุณ ููุฑ - ุงุญุชูุงู <bdi>Malware</bdi> |
| ูุงูุฏ ูุนุงู (ุบุฑ ุชู) | ุจุณุงุฑ ุจุงูุง | ุชุญูู <bdi>Process Tree</bdi> |
| ุนุฏู ูุฌูุฏ ูุฑุฒูุฏุงู ุงูุชุธุงุฑ ุฑูุชู | ุจุงูุง | ุงุญุชูุงู <bdi>Process Termination</bdi> ุชูุณุท ููุงุฌู |
| ูุฌูุฏ ูุฑุฒูุฏุงู ุบุฑูุนููู | ุจุงูุง | ุจุฑุฑุณ ุฏูู ูุฑุขูุฏูุง ูุฑุฒูุฏ |

---

### 5. Service Control Manager (services.exe)

<table dir="rtl">
<tr>
<th>ูฺฺฏ</th>
<th>ููุฏุงุฑ ูุฑูุงู</th>
</tr>
<tr>
<td><b>ูุงู ูุฑุขูุฏ</b></td>
<td><code>services.exe</code></td>
</tr>
<tr>
<td><b>ูุณุฑ ุงุฌุฑุง</b></td>
<td><code>%SystemRoot%\System32\services.exe</code></td>
</tr>
<tr>
<td><b>ูุงูุฏ</b></td>
<td><code>wininit.exe</code></td>
</tr>
<tr>
<td><b>ูุฑุฒูุฏุงู</b></td>
<td>โข ุชูุงู ูููููโูุง <code>svchost.exe</code><br>โข <code>spoolsv.exe</code><br>โข <code>SearchIndexer.exe</code><br>โข ุณุฑูุณโูุง ูุณุชูู ุฏฺฏุฑ</td>
</tr>
<tr>
<td><b>ุญุณุงุจ ฺฉุงุฑุจุฑ</b></td>
<td><bdi>NT AUTHORITY\SYSTEM</bdi></td>
</tr>
<tr>
<td><b>Session ID</b></td>
<td>0</td>
</tr>
<tr>
<td><b>ุชุนุฏุงุฏ ููููู</b></td>
<td>ููุท ฺฉ ููููู</td>
</tr>
</table>

**ุชูุถุญุงุช ุชฺฉูู:**

<bdi>Service Control Manager (SCM)</bdi> ููุจ ุณุณุชู ูุฏุฑุช ุณุฑูุณโูุง ููุฏูุฒ ุงุณุช. ุงู ูุฑุขูุฏ ูุณุฆููุชโูุง ุญุงุช ุฒุฑ ุฑุง ุฏุงุฑุฏ:

- **ุดุฑูุน ู ุชููู ุณุฑูุณโูุง** (<bdi>Start, Stop, Pause, Resume</bdi>)
- **ูุฏุฑุช ูุงุจุณุชฺฏโูุง ุณุฑูุณโูุง** (<bdi>Service Dependencies</bdi>)
- **ูพุงุฏูโุณุงุฒ Unified Background Process Manager (UBPM)**
- **ุชูุธู Last Known Good Configuration** ูพุณ ุงุฒ ุจูุช ูููู

**ูููุนุช ุฑุฌุณุชุฑ ุณุฑูุณโูุง:**
```
HKLM\SYSTEM\CurrentControlSet\Services\
```

ูุฑ ุณุฑูุณ ฺฉ ฺฉูุฏ ูุฌุฒุง ุฏุฑ ุงู ูุณุฑ ุฏุงุฑุฏ ฺฉู ุดุงูู ุงุทูุงุนุงุช ุฒุฑ ุงุณุช:
- `ImagePath`: ูุณุฑ ูุงู ุงุฌุฑุง
- `Start`: ููุน ุฑุงูโุงูุฏุงุฒ (<bdi>Automatic, Manual, Disabled</bdi>)
- `Type`: ููุน ุณุฑูุณ (<bdi>Win32OwnProcess, Win32ShareProcess</bdi>)
- `ServiceDll`: ูุณุฑ <bdi>DLL</bdi> ุจุฑุง ุณุฑูุณโูุง <bdi>svchost.exe</bdi>

**๐จ ุนูุงุฆู ูุดุฏุงุฑ ุงููุช:**

| ูุดุงูู ูุดฺฉูฺฉ | ุงุญุชูุงู ุชูุฏุฏ | ุชฺฉูฺฉ MITRE | ุงูุฏุงู ุชูุตูโุดุฏู |
|-------------|--------------|-------------|-----------------|
| ุจุด ุงุฒ ฺฉ ููููู | ุจุณุงุฑ ุจุงูุง | T1036 | ุจุฑุฑุณ ููุฑ |
| ูุงูุฏ ุบุฑ ุงุฒ `wininit.exe` | ุจุณุงุฑ ุจุงูุง | T1055 | ุงุญุชูุงู <bdi>Process Injection</bdi> |
| ูุฑุฒูุฏุงู ุบุฑูุนููู (ุบุฑุณุฑูุณ) | ุจุงูุง | T1543.003 | ุจุฑุฑุณ ุณุฑูุณโูุง ูุตุจโุดุฏู |
| ุชุบุฑ ุฏุฑ ุฑุฌุณุชุฑ ุณุฑูุณโูุง | ูุชูุณุท | T1543.003 | <bdi>Windows Service Persistence</bdi> |

**ูฺฉุชู ููู:** ูพุณ ุงุฒ ูุฑูุฏ ูููู ฺฉุงุฑุจุฑุ <bdi>SCM</bdi> ุจูุช ุฑุง ูููู ุชูู ฺฉุฑุฏู ู ููุฏุงุฑ `HKLM\SYSTEM\Select\LastKnownGood` ุฑุง ุจู `CurrentControlSet` ุชูุธู ูโฺฉูุฏ.

---

### 6. Generic Host Process for Services (svchost.exe)

<table dir="rtl">
<tr>
<th>ูฺฺฏ</th>
<th>ููุฏุงุฑ ูุฑูุงู</th>
</tr>
<tr>
<td><b>ูุงู ูุฑุขูุฏ</b></td>
<td><code>svchost.exe</code></td>
</tr>
<tr>
<td><b>ูุณุฑ ุงุฌุฑุง</b></td>
<td><code>%SystemRoot%\System32\svchost.exe</code></td>
</tr>
<tr>
<td><b>ูุงูุฏ</b></td>
<td><code>services.exe</code></td>
</tr>
<tr>
<td><b>ูุฑุฒูุฏุงู</b></td>
<td>ูุนูููุงู ูฺ (ุจู ุฌุฒ ููุงุฑุฏ ุฎุงุต)</td>
</tr>
<tr>
<td><b>ุญุณุงุจ ฺฉุงุฑุจุฑ</b></td>
<td>โข <bdi>SYSTEM</bdi><br>โข <bdi>LOCAL SERVICE</bdi><br>โข <bdi>NETWORK SERVICE</bdi><br>โข ุญุณุงุจโูุง ฺฉุงุฑุจุฑ ุฏูุฎูุงู</td>
</tr>
<tr>
<td><b>ุขุฑฺฏููุงูโูุง ุงูุฒุงู</b></td>
<td><code>-k &lt;ServiceGroup&gt;</code> (ููุดู)</td>
</tr>
<tr>
<td><b>ุชุนุฏุงุฏ ููููู</b></td>
<td><bdi>Windows 10 1703-</bdi>: 10-20<br><bdi>Windows 10 1703+</bdi>: 50-100+</td>
</tr>
</table>

**ุชูุถุญุงุช ุชฺฉูู:**

<bdi>svchost.exe</bdi> ฺฉ ูุฒุจุงู ุนููู ุจุฑุง ุณุฑูุณโูุง ุงุณุช ฺฉู ุจู ุตูุฑุช <bdi>DLL</bdi> ูพุงุฏูโุณุงุฒ ุดุฏูโุงูุฏ. ุจู ุฏูู ฺฉุงูุด ูุตุฑู ููุงุจุนุ ููุฏูุฒ ุจุณุงุฑ ุงุฒ ุณุฑูุณโูุง ุฑุง ุจู ุตูุฑุช <bdi>DLL</bdi> ููุดุชู ู ุขูโูุง ุฑุง ุฏุฑ ูููููโูุง ูุฎุชูู <bdi>svchost.exe</bdi> ุงุฌุฑุง ูโฺฉูุฏ.

**ุขุฑฺฏููุงูโูุง ุฎุท ูุฑูุงู:**

| ูพุงุฑุงูุชุฑ | ุชูุถุญ | ูุซุงู |
|---------|-------|------|
| <code>-k</code> | ฺฏุฑูู ุณุฑูุณ (<bdi>Service Host Group</bdi>) - <b>ุงูุฒุงู</b> | <code>-k netsvcs</code> |
| <code>-s</code> | ูุงู ุณุฑูุณ ุฎุงุต | <code>-s LanmanServer</code> |
| <code>-p</code> | ุงุฌุฑุง ุณุงุณุช (<bdi>Policy Enforcement</bdi>) | <code>-p</code> |

**ฺฏุฑููโูุง ุณุฑูุณ ูุนููู:**

```
-k DcomLaunch          โ DCOM ู RPC
-k RPCSS               โ RPC Endpoint Mapper
-k LocalService        โ ุณุฑูุณโูุง ูุญู
-k netsvcs             โ ุณุฑูุณโูุง ุดุจฺฉู
-k NetworkService      โ ุณุฑูุณโูุง ุดุจฺฉูโุง
-k UnistackSvcGroup    โ ุณุฑูุณโูุง Networking Stack
```

**ุชุบุฑุงุช ููู ุฏุฑ Windows 10 1703:**

ูุจู ุงุฒ ุงู ูุณุฎูุ ุณุฑูุณโูุง ูุดุงุจู ุฏุฑ ฺฉ ููููู <bdi>svchost.exe</bdi> ฺฏุฑููโุจูุฏ ูโุดุฏูุฏ. ุงุฒ <bdi>Windows 10 1703</bdi> ุจู ุจุนุฏุ ุฏุฑ ุณุณุชูโูุง ุจุง ุจุด ุงุฒ 3.5 ฺฏฺฏุงุจุงุช <bdi>RAM</bdi>ุ ูุฑ ุณุฑูุณ ููููู ูุณุชูู ุฎูุฏ ุฑุง ุฏุงุฑุฏ. ุงู ุชุบุฑ ุจุฑุง:
- **ุงูุฒุงุด ูุงุจูุช ุงุทููุงู** (ูุดฺฉู ุฏุฑ ฺฉ ุณุฑูุณ ุฏฺฏุฑ ุณุฑูุณโูุง ุฑุง ุชุญุช ุชุฃุซุฑ ูุฑุงุฑ ููโุฏูุฏ)
- **ุงูุฒุงุด ุงููุช** (ุงุฒูููโุณุงุฒ ุณุฑูุณโูุง)
- **ุจูุจูุฏ ูุธุงุฑุช ู ุนุจโุงุจ**

**ฺฺฏููู ุณุฑูุณโูุง ุฏุฑูู svchost.exe ุฑุง ุจุจููุ**

**ุฑูุด 1: Process Explorer**
1. ุฏุงูููุฏ <bdi>Process Explorer</bdi> ุงุฒ <bdi>Sysinternals</bdi>
2. ูพุฏุง ฺฉุฑุฏู ููููู <bdi>svchost.exe</bdi>
3. <bdi>Double-click</bdi> โ ุชุจ <bdi>Services</bdi>

**ุฑูุด 2: Command Line**
```cmd
tasklist /svc /fi "imagename eq svchost.exe"
```

**ุฑูุด 3: PowerShell**
```powershell
Get-Process svchost | Select-Object Id, @{Name="Services";Expression={(Get-WmiObject Win32_Service | Where-Object {$_.ProcessId -eq $_.Id}).Name}}
```

**๐จ ุนูุงุฆู ูุดุฏุงุฑ ุงููุช:**

| ูุดุงูู ูุดฺฉูฺฉ | ุงุญุชูุงู ุชูุฏุฏ | ุชฺฉูฺฉ MITRE | ุงูุฏุงู ุชูุตูโุดุฏู |
|-------------|--------------|-------------|-----------------|
| ุงุฌุฑุง ุจุฏูู ูพุงุฑุงูุชุฑ `-k` | ุจุณุงุฑ ุจุงูุง | T1036 | ุจุฑุฑุณ ููุฑ - ุงุญุชูุงู <bdi>Malware</bdi> |
| ูุงูุฏ ุบุฑ ุงุฒ `services.exe` | ุจุณุงุฑ ุจุงูุง | T1055 | ุงุญุชูุงู <bdi>Process Injection</bdi> |
| ูุณุฑ ุงุฌุฑุง ูุดฺฉูฺฉ | ุจุณุงุฑ ุจุงูุง | T1036.005 | ุงุญุชูุงู <bdi>Masquerading</bdi>: `svch0st.exe` |
| ูุตุฑู <bdi>CPU/Network</bdi> ุบุฑุนุงุฏ | ูุชูุณุท | T1496 | ุงุญุชูุงู <bdi>Cryptomining</bdi> ุง <bdi>C2 Communication</bdi> |
| ุงุชุตุงูุงุช ุดุจฺฉู ุจู IPูุง ูุดฺฉูฺฉ | ุจุงูุง | T1071 | ุจุฑุฑุณ <bdi>Network Connections</bdi> ุจุง `netstat` |
| ุณุฑูุณโูุง ูุงุดูุงุฎุชู ุฏุฑ <bdi>svchost.exe</bdi> | ุจุงูุง | T1543.003 | ุจุฑุฑุณ ุฑุฌุณุชุฑ ุณุฑูุณ |

**ูุซุงู Command Line ูุฑูุงู:**
```
C:\Windows\System32\svchost.exe -k netsvcs -p -s Schedule
```

**ูุซุงู Command Line ูุดฺฉูฺฉ:**
```
C:\Windows\System32\svchost.exe
```
*(ุจุฏูู ูพุงุฑุงูุชุฑ -k)*

---

### 7. Local Security Authority Subsystem (lsass.exe)

<table dir="rtl">
<tr>
<th>ูฺฺฏ</th>
<th>ููุฏุงุฑ ูุฑูุงู</th>
</tr>
<tr>
<td><b>ูุงู ูุฑุขูุฏ</b></td>
<td><code>lsass.exe</code></td>
</tr>
<tr>
<td><b>ูุณุฑ ุงุฌุฑุง</b></td>
<td><code>%SystemRoot%\System32\lsass.exe</code></td>
</tr>
<tr>
<td><b>ูุงูุฏ</b></td>
<td><code>wininit.exe</code></td>
</tr>
<tr>
<td><b>ูุฑุฒูุฏุงู</b></td>
<td>ุจู ูุฏุฑุช (ุงุณุชุซูุงุก: <bdi>EFS - Encrypting File System</bdi>)</td>
</tr>
<tr>
<td><b>ุญุณุงุจ ฺฉุงุฑุจุฑ</b></td>
<td><bdi>NT AUTHORITY\SYSTEM</bdi></td>
</tr>
<tr>
<td><b>Session ID</b></td>
<td>0</td>
</tr>
<tr>
<td><b>ุชุนุฏุงุฏ ููููู</b></td>
<td>ููุท ฺฉ ููููู</td>
</tr>
<tr>
<td><b>Protected Process</b></td>
<td>ุจูู (<bdi>Windows 8.1+</bdi>)</td>
</tr>
</table>

**ุชูุถุญุงุช ุชฺฉูู:**

<bdi>LSASS (Local Security Authority Subsystem Service)</bdi> ฺฉ ุงุฒ ุญุณุงุณโุชุฑู ูุฑุขูุฏูุง ุงููุช ููุฏูุฒ ุงุณุช. ุงู ูุฑุขูุฏ ูุธุงู ุจุญุฑุงู ุฒุฑ ุฑุง ุฏุงุฑุฏ:

- **ูุฏุฑุช ุงุญุฑุงุฒ ููุช** (<bdi>Authentication</bdi>): <bdi>Kerberos</bdi> ุจุฑุง ุฏุงูููุ <bdi>MSV1_0</bdi> ุจุฑุง ูุญู
- **ุงุฌุฑุง ุณุงุณุชโูุง ุงููุช ูุญู** (<bdi>Local Security Policy</bdi>)
- **ูุฏุฑุช ุงุนุชุจุงุฑูุงููโูุง** (<bdi>Credential Management</bdi>)
- **ููุดุชู ุฑูุฏุงุฏูุง ุฏุฑ Security Log**

**ุญุงูุธู lsass.exe ฺู ฺุฒ ุฏุงุฑุฏุ**

ุญุงูุธู ุงู ูุฑุขูุฏ ุดุงูู ุงุทูุงุนุงุช ุญุงุช ุฒุฑ ุงุณุช:
- <bdi>Password Hashes (NTLM, LM)</bdi>
- <bdi>Kerberos Tickets (TGT, Service Tickets)</bdi>
- <bdi>Plaintext Passwords</bdi> (ุฏุฑ ุจุฑุฎ ูพฺฉุฑุจูุฏโูุง)
- <bdi>Security Tokens</bdi>

**ุจู ููู ุฏููุ lsass.exe ูุฏู ุงุตู ุญููุงุช Credential Dumping ุงุณุช.**

#### lsaiso.exe ู Credential Guard

ุฏุฑ ุณุณุชูโูุง ฺฉู <bdi>Virtualization-Based Security (VBS)</bdi> ู <bdi>Credential Guard</bdi> ูุนุงู ุงุณุชุ ูุฑุขูุฏ ุฌุฏุฏ ุจู ูุงู <bdi>lsaiso.exe</bdi> ุธุงูุฑ ูโุดูุฏ.

<table dir="rtl">
<tr>
<th>ูฺฺฏ</th>
<th>ููุฏุงุฑ</th>
</tr>
<tr>
<td><b>ูุงู ูุฑุขูุฏ</b></td>
<td><code>lsaiso.exe</code></td>
</tr>
<tr>
<td><b>ูุณุฑ ุงุฌุฑุง</b></td>
<td><code>%SystemRoot%\System32\lsaiso.exe</code></td>
</tr>
<tr>
<td><b>ูุงูุฏ</b></td>
<td><code>wininit.exe</code></td>
</tr>
<tr>
<td><b>ูุญุท ุงุฌุฑุง</b></td>
<td><bdi>Virtual Secure Mode (VSM)</bdi></td>
</tr>
<tr>
<td><b>ูุธูู</b></td>
<td>ุฐุฎุฑูโุณุงุฒ ุงูู ุงุนุชุจุงุฑูุงููโูุง</td>
</tr>
</table>

**ุชูุณู ูุธุงู:**
- <bdi>lsass.exe</bdi>: ูุฏุฑุช ุงุญุฑุงุฒ ููุช ู ุณุงุณุชโูุง
- <bdi>lsaiso.exe</bdi>: ุฐุฎุฑูโุณุงุฒ ุงูู ุงุนุชุจุงุฑูุงููโูุง ุฏุฑ ูุญุท ุงุฒููู

ุฒูุงู ฺฉู <bdi>Credential Guard</bdi> ูุนุงู ุงุณุชุ ุญุช ุจุง ุฏุณุชุฑุณ <bdi>SYSTEM</bdi> ู <bdi>Debug Privilege</bdi>ุ ุงุณุชุฎุฑุงุฌ ุงุนุชุจุงุฑูุงููโูุง ุงุฒ <bdi>lsass.exe</bdi> ุบุฑููฺฉู ุงุณุช.

**๐จ ุนูุงุฆู ูุดุฏุงุฑ ุงููุช:**

| ูุดุงูู ูุดฺฉูฺฉ | ุงุญุชูุงู ุชูุฏุฏ | ุชฺฉูฺฉ MITRE | ุงูุฏุงู ุชูุตูโุดุฏู |
|-------------|--------------|-------------|-----------------|
| ุจุด ุงุฒ ฺฉ ููููู `lsass.exe` | ุจุณุงุฑ ุจุงูุง | T1036 | ุจุฑุฑุณ ููุฑ - ุงุญุชูุงู <bdi>Masquerading</bdi> |
| ูุงูุฏ ุบุฑ ุงุฒ `wininit.exe` | ุจุณุงุฑ ุจุงูุง | T1055 | ุงุญุชูุงู <bdi>Process Injection</bdi> |
| ูุฑุขูุฏูุง ูุฑุฒูุฏ ุบุฑูุนููู | ุจุงูุง | T1055 | ุจุฑุฑุณ ุฏูู |
| ุฏุณุชุฑุณ ุจู ุญุงูุธู ุงุฒ ูุฑุขูุฏูุง ุบุฑูุนููู | ุจุณุงุฑ ุจุงูุง | T1003.001 | <bdi>Credential Dumping Attack</bdi> |
| ูุฌูุฏ `lsaiso.exe` ุจุง <bdi>VBS</bdi> ุบุฑูุนุงู | ุจุงูุง | T1036 | ุงุญุชูุงู <bdi>Malware</bdi> |

**ุงุจุฒุงุฑูุง ูุนููู ุญููู ุจู lsass.exe:**

| ุงุจุฒุงุฑ | ุชฺฉูฺฉ | ุดูุงุณุง |
|-------|--------|---------|
| <bdi>Mimikatz</bdi> | ุงุณุชุฎุฑุงุฌ ุงุนุชุจุงุฑูุงูู ุงุฒ ุญุงูุธู | <bdi>Sysmon Event ID 10</bdi> |
| <bdi>ProcDump</bdi> | ุงุฌุงุฏ <bdi>Memory Dump</bdi> | ุฏุณุชุฑุณ <bdi>PROCESS_VM_READ</bdi> |
| <bdi>Comsvcs.dll</bdi> | <bdi>MiniDump</bdi> ุงุฒ ุทุฑู <bdi>rundll32</bdi> | ูุฑุงุฎูุงู `MiniDump` |
| <bdi>Task Manager</bdi> | ุงุฌุงุฏ <bdi>Dump File</bdi> | ุฏุณุชุฑุณ ุงุฒ ฺฉุงุฑุจุฑ ุจุง <bdi>Admin Rights</bdi> |

**Command Line ูุดฺฉูฺฉ:**
```cmd
rundll32.exe C:\windows\System32\comsvcs.dll, MiniDump <PID> C:\temp\lsass.dmp full
```

---

### 8. Windows Logon Process (winlogon.exe)

<table dir="rtl">
<tr>
<th>ูฺฺฏ</th>
<th>ููุฏุงุฑ ูุฑูุงู</th>
</tr>
<tr>
<td><b>ูุงู ูุฑุขูุฏ</b></td>
<td><code>winlogon.exe</code></td>
</tr>
<tr>
<td><b>ูุณุฑ ุงุฌุฑุง</b></td>
<td><code>%SystemRoot%\System32\winlogon.exe</code></td>
</tr>
<tr>
<td><b>ูุงูุฏ</b></td>
<td>ุชู - ูุงูุฏ ุงุตู: ููููู ูุฑุฒูุฏ <code>smss.exe</code> (Session 1+)</td>
</tr>
<tr>
<td><b>ูุฑุฒูุฏุงู</b></td>
<td>โข <code>LogonUI.exe</code><br>โข <code>userinit.exe</code><br>โข <code>dwm.exe</code> (<bdi>Desktop Window Manager</bdi>)<br>โข <code>fontdrvhost.exe</code></td>
</tr>
<tr>
<td><b>ุญุณุงุจ ฺฉุงุฑุจุฑ</b></td>
<td><bdi>NT AUTHORITY\SYSTEM</bdi></td>
</tr>
<tr>
<td><b>Session ID</b></td>
<td>1+ (ฺฉ ุจุฑุง ูุฑ ูุดุณุช ฺฉุงุฑุจุฑ)</td>
</tr>
<tr>
<td><b>ุชุนุฏุงุฏ ููููู</b></td>
<td>ฺฉ ุจุฑุง ูุฑ <bdi>User Session</bdi></td>
</tr>
</table>

**ุชูุถุญุงุช ุชฺฉูู:**

<bdi>winlogon.exe</bdi> ูุณุฆูู ูุฏุฑุช ฺฉุงูู ูุฑูุฏ ู ุฎุฑูุฌ ฺฉุงุฑุจุฑุงู ุงุณุช:

- **ููุงุด ุตูุญู ูุฑูุฏ** (<bdi>Logon Screen</bdi>)
- **ุฏุฑุงูุช ุงุนุชุจุงุฑูุงููโูุง** ู ุงุฑุณุงู ุจู <bdi>LSASS</bdi>
- **ุฑุงูโุงูุฏุงุฒ User Shell** (ูุนูููุงู `explorer.exe`)
- **ูุฏุฑุช Lock Workstation** (<kbd>Win+L</kbd>)
- **ูุฏุฑุช User Profile**

**ฺฉูุฏูุง ุฑุฌุณุชุฑ ุญุงุช:**

| ฺฉูุฏ ุฑุฌุณุชุฑ | ุชูุถุญ | ููุฏุงุฑ ูพุดโูุฑุถ |
|--------------|--------|----------------|
| <code>HKLM\...\Winlogon\Userinit</code> | ูุฑุขูุฏ ุงุฌุฑุง ูพุณ ุงุฒ ูุฑูุฏ | <code>userinit.exe</code> |
| <code>HKLM\...\Winlogon\Shell</code> | ูพูุณุชู ูพุดโูุฑุถ ฺฉุงุฑุจุฑ | <code>explorer.exe</code> |
| <code>HKLM\...\Winlogon\Notify</code> | <bdi>DLLูุง Notification</bdi> | - |
| <code>HKCU\...\Winlogon\Shell</code> | ูพูุณุชู ุงุฎุชุตุงุต ฺฉุงุฑุจุฑ | - |

**โ๏ธ ููุทู ุจุญุฑุงู ุจุฑุง Persistence:**

ููุงุฌูุงู ุงุบูุจ ฺฉูุฏูุง ุฑุฌุณุชุฑ <bdi>Winlogon</bdi> ุฑุง ุจุฑุง ูพุงุฏุงุฑ (<bdi>Persistence</bdi>) ุชุบุฑ ูโุฏููุฏ:

**ูุซุงู ุญููู:**
```reg
HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Userinit
ููุฏุงุฑ: C:\Windows\System32\userinit.exe, C:\Malware\backdoor.exe
```

**๐จ ุนูุงุฆู ูุดุฏุงุฑ ุงููุช:**

| ูุดุงูู ูุดฺฉูฺฉ | ุงุญุชูุงู ุชูุฏุฏ | ุชฺฉูฺฉ MITRE | ุงูุฏุงู ุชูุตูโุดุฏู |
|-------------|--------------|-------------|-----------------|
| ูุงูุฏ ูุนุงู (ุบุฑ ุชู) | ุจุณุงุฑ ุจุงูุง | T1055 | ุจุฑุฑุณ ููุฑ |
| ุงุฌุฑุง ุจุง ุญุณุงุจ ุบุฑ ุงุฒ <bdi>SYSTEM</bdi> | ุจุณุงุฑ ุจุงูุง | T1134 | ุงุญุชูุงู <bdi>Token Manipulation</bdi> |
| ุชุบุฑ ฺฉูุฏูุง ุฑุฌุณุชุฑ <bdi>Winlogon</bdi> | ุจุณุงุฑ ุจุงูุง | T1547.004 | <bdi>Winlogon Helper DLL Persistence</bdi> |
| ุนุฏู ูุฌูุฏ `userinit.exe` ุจู ุนููุงู ูุฑุฒูุฏ | ุจุงูุง | T1562 | ุงุญุชูุงู ูุฏุงุฎูู ุฏุฑ ูุฑุขูุฏ ูุฑูุฏ |

**ููููู Command Line ูุฑูุงู:**
```
winlogon.exe
```

---

### 9. User Initialization (userinit.exe)

<table dir="rtl">
<tr>
<th>ูฺฺฏ</th>
<th>ููุฏุงุฑ ูุฑูุงู</th>
</tr>
<tr>
<td><b>ูุงู ูุฑุขูุฏ</b></td>
<td><code>userinit.exe</code></td>
</tr>
<tr>
<td><b>ูุณุฑ ุงุฌุฑุง</b></td>
<td><code>%SystemRoot%\System32\userinit.exe</code></td>
</tr>
<tr>
<td><b>ูุงูุฏ</b></td>
<td><code>winlogon.exe</code></td>
</tr>
<tr>
<td><b>ูุฑุฒูุฏุงู</b></td>
<td><code>explorer.exe</code></td>
</tr>
<tr>
<td><b>ุญุณุงุจ ฺฉุงุฑุจุฑ</b></td>
<td>ฺฉุงุฑุจุฑ ูุงุฑุฏ ุดุฏู</td>
</tr>
<tr>
<td><b>ุฑูุชุงุฑ</b></td>
<td>ูพุณ ุงุฒ ุฑุงูโุงูุฏุงุฒ <code>explorer.exe</code> ุฎุงุชูู ูโุงุจุฏ</td>
</tr>
</table>

**ุชูุถุญุงุช ุชฺฉูู:**

<bdi>userinit.exe</bdi> ฺฉ ูุฑุขูุฏ ฺฉูุชุงูโูุฏุช ุงุณุช ฺฉู ูุธุงู ุฒุฑ ุฑุง ุงูุฌุงู ูโุฏูุฏ:

- **ุจุงุฑฺฏุฐุงุฑ User Profile**
- **ุงุฌุฑุง Login Scripts**
- **ุงุนูุงู Group Policy**
- **ุฑุงูโุงูุฏุงุฒ Shell** (ูุนูููุงู `explorer.exe`)
- **ุฎุงุชูู ุฎูุฏฺฉุงุฑ**

ุงู ูุฑุขูุฏ ุจู ูุฏุฑุช ุฏุฑ <bdi>Process List</bdi> ุฏุฏู ูโุดูุฏ ุฒุฑุง ุจุณุงุฑ ุณุฑุน ุฎุงุชูู ูโุงุจุฏ.

---

### 10. Windows Explorer (explorer.exe)

<table dir="rtl">
<tr>
<th>ูฺฺฏ</th>
<th>ููุฏุงุฑ ูุฑูุงู</th>
</tr>
<tr>
<td><b>ูุงู ูุฑุขูุฏ</b></td>
<td><code>explorer.exe</code></td>
</tr>
<tr>
<td><b>ูุณุฑ ุงุฌุฑุง</b></td>
<td><code>%SystemRoot%\explorer.exe</code> (ูู <code>System32</code>)</td>
</tr>
<tr>
<td><b>ูุงูุฏ</b></td>
<td>ุชู - ูุงูุฏ ุงุตู: <code>userinit.exe</code></td>
</tr>
<tr>
<td><b>ูุฑุฒูุฏุงู</b></td>
<td>ุงฺฉุซุฑ ุจุฑูุงููโูุง ุงุฌุฑุงุดุฏู ุชูุณุท ฺฉุงุฑุจุฑ</td>
</tr>
<tr>
<td><b>ุญุณุงุจ ฺฉุงุฑุจุฑ</b></td>
<td>ฺฉุงุฑุจุฑ ูุงุฑุฏ ุดุฏู</td>
</tr>
<tr>
<td><b>ุชุนุฏุงุฏ ููููู</b></td>
<td>ูุนูููุงู 1 (ููฺฉู ุงุณุช ุจุดุชุฑ ุจุงุดุฏ)</td>
</tr>
</table>

**ุชูุถุญุงุช ุชฺฉูู:**

<bdi>explorer.exe</bdi> ูพูุณุชู ฺฏุฑุงูฺฉ ูพุดโูุฑุถ ููุฏูุฒ ุงุณุช ฺฉู ุดุงูู:

- **Desktop Environment**
- **Start Menu**
- **Taskbar**
- **File Explorer**
- **System Tray**

**ฺุฑุง explorer.exe ูุงูุฏ ุงฺฉุซุฑ ูุฑุขูุฏูุง ุงุณุชุ**

ุฒูุงู ฺฉู ฺฉุงุฑุจุฑ ุฑู ฺฉ ูุงู ุง ูุงูุจุฑ ฺฉูฺฉ ูโฺฉูุฏุ <bdi>explorer.exe</bdi> ุขู ุจุฑูุงูู ุฑุง ุฑุงูโุงูุฏุงุฒ ูโฺฉูุฏ. ุจูุงุจุฑุงู ุงฺฉุซุฑ ุจุฑูุงููโูุง ุชุนุงูู (ูุงููุฏ <bdi>browser</bdi>ูุงุ <bdi>Office</bdi>ุ ุจุงุฒโูุง) ูุงูุฏ ุขูโูุง <bdi>explorer.exe</bdi> ุงุณุช.

**ฺูุฏ ููููู explorer.exeุ**

ฺฏุฒูู **"Launch folder windows in a separate process"** ุฏุฑ ููุฏูุฒ ูโุชูุงูุฏ ููุฌุฑ ุจู ฺูุฏู ููููู ุดูุฏ.

**๐จ ุนูุงุฆู ูุดุฏุงุฑ ุงููุช:**

| ูุดุงูู ูุดฺฉูฺฉ | ุงุญุชูุงู ุชูุฏุฏ | ุชฺฉูฺฉ MITRE | ุงูุฏุงู ุชูุตูโุดุฏู |
|-------------|--------------|-------------|-----------------|
| ูุณุฑ ุงุฌุฑุง ุฏุฑ `System32` | ุจุณุงุฑ ุจุงูุง | T1036.005 | ุจุงุฏ ุฏุฑ `%SystemRoot%` ุจุงุดุฏ |
| ุงุฌุฑุง ุจุง ุญุณุงุจ <bdi>SYSTEM</bdi> | ุจุณุงุฑ ุจุงูุง | T1134 | ุงุญุชูุงู <bdi>Privilege Escalation</bdi> |
| ุฑุงูโุงูุฏุงุฒ `cmd.exe` ุง `powershell.exe` ุจุฏูู ุชุนุงูู ฺฉุงุฑุจุฑ | ุจุงูุง | T1059 | ุงุญุชูุงู <bdi>Command Execution Attack</bdi> |
| ุชุบุฑ ฺฉูุฏ `Shell` ุฏุฑ ุฑุฌุณุชุฑ | ุจุณุงุฑ ุจุงูุง | T1546.015 | <bdi>Persistence via Shell Replacement</bdi> |

**ูุซุงู ุญููู Persistence:**
```reg
HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Shell
ููุฏุงุฑ: C:\Malware\fake_explorer.exe
```

---

## ููุงูู ุดูุงุณุง ู ฺฺฉโูุณุช ุนููุงุช

### ๐ ฺฺฉโูุณุช ุชุญูู ูุฑุขูุฏูุง

ุจุฑุง ูุฑ ูุฑุขูุฏุ ููุงุฑุฏ ุฒุฑ ุฑุง ุจุฑุฑุณ ฺฉูุฏ:

#### 1. **ุงุนุชุจุงุฑุณูุฌ ูุณุฑ ุงุฌุฑุง**
```powershell
# PowerShell: ุจุฑุฑุณ ูุณุฑ ูุฑุขูุฏูุง
Get-Process | Select-Object Name, Path | Where-Object {$_.Name -match "svchost|lsass|csrss|winlogon"}
```

#### 2. **ุจุฑุฑุณ ุฑูุงุจุท ูุงูุฏ-ูุฑุฒูุฏ**
```powershell
# PowerShell: ููุงุด Process Tree
Get-CimInstance Win32_Process | Select-Object ProcessId, ParentProcessId, Name, CommandLine
```

#### 3. **ุจุฑุฑุณ ุญุณุงุจ ฺฉุงุฑุจุฑ**
```powershell
# PowerShell: ุจุฑุฑุณ User Context
Get-Process | Select-Object Name, @{Name="Owner";Expression={(Get-WmiObject Win32_Process -Filter "ProcessId=$($_.Id)").GetOwner().User}}
```

#### 4. **ุจุฑุฑุณ ุขุฑฺฏููุงูโูุง ุฎุท ูุฑูุงู**
```powershell
# PowerShell: ุจุฑุฑุณ Command Line Arguments
Get-CimInstance Win32_Process | Where-Object {$_.Name -eq "svchost.exe"} | Select-Object ProcessId, CommandLine
```

#### 5. **ุจุฑุฑุณ Network Connections**
```powershell
# PowerShell: ุจุฑุฑุณ ุงุชุตุงูุงุช ุดุจฺฉู ูุดฺฉูฺฉ
Get-NetTCPConnection | Where-Object {$_.State -eq "Established"} | Select-Object LocalAddress, LocalPort, RemoteAddress, RemotePort, OwningProcess, @{Name="Process";Expression={(Get-Process -Id $_.OwningProcess).Name}}
```

### ๐ ุฌุฏูู ุฎูุงุตู ูุฑุขูุฏูุง ุญุงุช

| ูุฑุขูุฏ | PID | ูุงูุฏ | ูุณุฑ | ุญุณุงุจ ฺฉุงุฑุจุฑ | ูุฑุฒูุฏุงู ฺฉูุฏ |
|--------|-----|------|------|--------------|----------------|
| <code>System</code> | 4 | - | <code>ntoskrnl.exe</code> | SYSTEM | <code>smss.exe</code> |
| <code>smss.exe</code> | ูุชุบุฑ | System | <code>System32\smss.exe</code> | SYSTEM | <code>csrss.exe, wininit.exe, winlogon.exe</code> |
| <code>csrss.exe</code> | ูุชุบุฑ | ุชู | <code>System32\csrss.exe</code> | SYSTEM | ูฺ |
| <code>wininit.exe</code> | ูุชุบุฑ | ุชู | <code>System32\wininit.exe</code> | SYSTEM | <code>services.exe, lsass.exe</code> |
| <code>services.exe</code> | ูุชุบุฑ | <code>wininit.exe</code> | <code>System32\services.exe</code> | SYSTEM | <code>svchost.exe, ...</code> |
| <code>svchost.exe</code> | ูุชุบุฑ | <code>services.exe</code> | <code>System32\svchost.exe</code> | ูุชุบุฑ | ูุนูููุงู ูฺ |
| <code>lsass.exe</code> | ูุชุบุฑ | <code>wininit.exe</code> | <code>System32\lsass.exe</code> | SYSTEM | ุจู ูุฏุฑุช |
| <code>winlogon.exe</code> | ูุชุบุฑ | ุชู | <code>System32\winlogon.exe</code> | SYSTEM | <code>userinit.exe, LogonUI.exe</code> |
| <code>explorer.exe</code> | ูุชุบุฑ | ุชู | <code>%SystemRoot%\explorer.exe</code> | ฺฉุงุฑุจุฑ | ุงฺฉุซุฑ ุจุฑูุงููโูุง |

---

## ุงุจุฒุงุฑูุง ุชุญูู ู ูุธุงุฑุช

### ๐๏ธ ุงุจุฒุงุฑูุง Sysinternals

#### 1. Process Explorer
**ุฏุงูููุฏ:** https://learn.microsoft.com/en-us/sysinternals/downloads/process-explorer

**ูุงุจูุชโูุง:**
- ููุงุด Process Tree ฺฉุงูู
- ุจุฑุฑุณ DLLูุง ุจุงุฑฺฏุฐุงุฑโุดุฏู
- ุจุฑุฑุณ Handles ู Threads
- ุจุฑุฑุณ ุณุฑูุณโูุง ุฏุฑูู svchost.exe
- ุชุดุฎุต Packed/Signed Binaries

**ูฺฉุงุช ููู:**
- ุงุณุชูุงุฏู ุงุฒ <kbd>Ctrl+L</kbd> ุจุฑุง ูุดุงูุฏู DLLูุง ุจุงุฑฺฏุฐุงุฑโุดุฏู
- ุณุชูู <bdi>"Verified Signer"
